2025-07-13 20:23:02 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 11028 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:23:02 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:23:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:23:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 116 ms. Found 6 JPA repository interfaces.
2025-07-13 20:23:04 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:23:04 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:23:04 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:23:04 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:23:04 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1826 ms
2025-07-13 20:23:04 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:23:04 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:23:04 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:23:04 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:23:04 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:23:06 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@11bfd751
2025-07-13 20:23:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:23:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:23:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:23:06 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:23:07 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:23:08 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:23:08 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:23:09 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:23:09 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 20:23:09 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 20:23:09 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-07-13 20:23:09 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 20:23:10 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 20:23:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:23:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:23:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 20:23:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12bd2630]
2025-07-13 20:23:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12bd2630]
2025-07-13 20:23:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12bd2630]]
2025-07-13 20:23:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 20:23:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:23:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:23:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 20:23:10 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 8.751 seconds (process running for 9.281)
2025-07-13 20:23:26 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 20:23:26 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 20:23:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 20:23:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 20:23:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 20:23:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@5c3e0c92
2025-07-13 20:23:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3833a045
2025-07-13 20:23:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 20:23:26 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-07-13 20:23:26 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(MessageDto)
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.web.method.HandlerMethod - Could not resolve parameter [0] in public com.btalk.dto.response.ApiResponse<com.btalk.dto.MessageDto> com.btalk.controller.MessageController.sendMessage(com.btalk.dto.MessageDto): Content-Type 'multipart/form-data;boundary=----WebKitFormBoundaryBZpWMjSdtVhypBiT;charset=UTF-8' is not supported
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content-Type 'multipart/form-data;boundary=----WebKitFormBoundaryBZpWMjSdtVhypBiT;charset=UTF-8' is not supported]
2025-07-13 20:23:27 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:24:10 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-07-13 20:25:01 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:01 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752414901703", parameters={masked}
2025-07-13 20:25:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:25:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752414901703
2025-07-13 20:25:01 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:01 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/059/lc2bf5zr/websocket", parameters={}
2025-07-13 20:25:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:25:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/059/lc2bf5zr/websocket
2025-07-13 20:25:01 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752414901755", parameters={masked}
2025-07-13 20:25:01 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:25:01 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752414901755
2025-07-13 20:25:01 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:01 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:25:01 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/542/sduoeeut/websocket", parameters={}
2025-07-13 20:25:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:25:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/542/sduoeeut/websocket
2025-07-13 20:25:01 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:25:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lc2bf5zr]
2025-07-13 20:25:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=sduoeeut]
2025-07-13 20:25:01 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:25:01 [http-nio-8080-exec-1] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:25:01 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=sduoeeut
2025-07-13 20:25:01 [clientInboundChannel-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=lc2bf5zr
2025-07-13 20:25:01 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:25:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:25:01 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:25:01 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:25:01 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=sduoeeut
2025-07-13 20:25:01 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=lc2bf5zr
2025-07-13 20:25:01 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=sduoeeut
2025-07-13 20:25:01 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=lc2bf5zr
2025-07-13 20:25:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:25:01 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:25:02 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:02 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:25:02 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:02 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:25:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:25:03 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:04 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:04 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:25:04 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:18 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=sduoeeut
2025-07-13 20:25:18 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=sduoeeut
2025-07-13 20:25:18 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=sduoeeut
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:25:18 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:18 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:25:18 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:25:19 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:25:19 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:25:19 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=lc2bf5zr
2025-07-13 20:25:19 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=lc2bf5zr
2025-07-13 20:25:19 [clientInboundChannel-1] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=lc2bf5zr
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:25:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:25:19 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:25:19 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:25:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:25:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:25:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:25:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:25:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:25:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:25:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:20 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:25:20 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:25:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:25:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:25:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:25:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(MessageDto)
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.web.method.HandlerMethod - Could not resolve parameter [0] in public com.btalk.dto.response.ApiResponse<com.btalk.dto.MessageDto> com.btalk.controller.MessageController.sendMessage(com.btalk.dto.MessageDto): Content-Type 'multipart/form-data;boundary=----WebKitFormBoundary48ZEAZW289iGWmVT;charset=UTF-8' is not supported
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content-Type 'multipart/form-data;boundary=----WebKitFormBoundary48ZEAZW289iGWmVT;charset=UTF-8' is not supported]
2025-07-13 20:25:22 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:27:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=sduoeeut] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:27:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session sduoeeut
2025-07-13 20:27:31 [http-nio-8080-exec-2] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:27:31 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=sduoeeut
2025-07-13 20:27:31 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=sduoeeut}], simpSessionId=sduoeeut}]
2025-07-13 20:27:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lc2bf5zr] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:27:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session lc2bf5zr
2025-07-13 20:27:31 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:27:31 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=lc2bf5zr
2025-07-13 20:27:31 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=lc2bf5zr}], simpSessionId=lc2bf5zr}]
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:27:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415052315", parameters={masked}
2025-07-13 20:27:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:27:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415052315
2025-07-13 20:27:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:27:32 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415052343", parameters={masked}
2025-07-13 20:27:32 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:27:32 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415052343
2025-07-13 20:27:32 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:27:32 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/961/ph1qcqdg/websocket", parameters={}
2025-07-13 20:27:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:27:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/961/ph1qcqdg/websocket
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:27:32 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:27:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ph1qcqdg]
2025-07-13 20:27:32 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:27:32 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ph1qcqdg
2025-07-13 20:27:32 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ph1qcqdg
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:27:32 [clientInboundChannel-46] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ph1qcqdg
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:27:32 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/486/xbfumrph/websocket", parameters={}
2025-07-13 20:27:32 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@aa16802
2025-07-13 20:27:32 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/486/xbfumrph/websocket
2025-07-13 20:27:32 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:27:32 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=xbfumrph]
2025-07-13 20:27:32 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:27:32 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=xbfumrph
2025-07-13 20:27:32 [clientInboundChannel-52] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=xbfumrph
2025-07-13 20:27:32 [clientInboundChannel-55] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=xbfumrph
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:27:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:27:33 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:27:33 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:27:33 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:27:33 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:27:33 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:27:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:27:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:27:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:27:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:27:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:27:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:27:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 20:27:34 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:27:34 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:27:34 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:27:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:27:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:27:34 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:27:34 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session xbfumrph with CloseStatus[code=1001, reason=null]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=xbfumrph]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=xbfumrph] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session xbfumrph
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session ph1qcqdg with CloseStatus[code=1001, reason=null]
2025-07-13 20:27:34 [clientInboundChannel-58] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=xbfumrph
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=ph1qcqdg]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ph1qcqdg] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ph1qcqdg
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12bd2630]]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12bd2630]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12bd2630]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 20:27:34 [RMI TCP Connection(9)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 20:37:14 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 32748 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:37:14 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:37:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:37:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 148 ms. Found 6 JPA repository interfaces.
2025-07-13 20:37:15 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:37:15 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:37:15 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:37:15 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:37:15 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1529 ms
2025-07-13 20:37:15 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:37:15 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:37:15 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:37:16 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:37:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:37:17 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@404009df
2025-07-13 20:37:17 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:37:17 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:37:17 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:37:17 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:37:18 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:37:19 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:37:19 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:37:20 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:37:20 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'messageController' defined in file [C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes\com\btalk\controller\MessageController.class]: Unsatisfied dependency expressed through constructor parameter 2: No qualifying bean of type 'com.btalk.utils.FileStorageUtils' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
2025-07-13 20:37:20 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:37:20 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 20:37:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 20:37:21 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-07-13 20:37:21 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-07-13 20:37:21 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 2 of constructor in com.btalk.controller.MessageController required a bean of type 'com.btalk.utils.FileStorageUtils' that could not be found.


Action:

Consider defining a bean of type 'com.btalk.utils.FileStorageUtils' in your configuration.

2025-07-13 20:38:02 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 34476 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:38:02 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:38:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:38:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 124 ms. Found 6 JPA repository interfaces.
2025-07-13 20:38:04 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:38:04 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:38:04 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:38:04 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:38:04 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1670 ms
2025-07-13 20:38:04 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:38:04 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:38:04 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:38:05 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:38:05 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:38:06 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7c3c3d67
2025-07-13 20:38:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:38:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:38:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:38:06 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:38:07 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:38:08 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:38:08 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:38:09 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:38:09 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 20:38:09 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 20:38:09 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileController:
	
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 20:38:10 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 20:38:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:38:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:38:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 20:38:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21ec7946]
2025-07-13 20:38:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21ec7946]
2025-07-13 20:38:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21ec7946]]
2025-07-13 20:38:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 20:38:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:38:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:38:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 20:38:10 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 8.188 seconds (process running for 8.811)
2025-07-13 20:38:19 [http-nio-8080-exec-4] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 20:38:19 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4219e848
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3030a20
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 20:38:19 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415699167", parameters={masked}
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415699167
2025-07-13 20:38:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/505/u52m4fbd/websocket", parameters={}
2025-07-13 20:38:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:38:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/505/u52m4fbd/websocket
2025-07-13 20:38:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:38:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=u52m4fbd]
2025-07-13 20:38:19 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:38:19 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=u52m4fbd
2025-07-13 20:38:19 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=u52m4fbd
2025-07-13 20:38:19 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=u52m4fbd
2025-07-13 20:38:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:19 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:38:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:38:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:38:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:38:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:38:22 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:22 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:38:22 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415703296", parameters={masked}
2025-07-13 20:38:23 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:38:23 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415703296
2025-07-13 20:38:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:23 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/747/gkeelrdz/websocket", parameters={}
2025-07-13 20:38:23 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:38:23 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/747/gkeelrdz/websocket
2025-07-13 20:38:23 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:38:23 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=gkeelrdz]
2025-07-13 20:38:23 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:38:23 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=gkeelrdz
2025-07-13 20:38:23 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=gkeelrdz
2025-07-13 20:38:23 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=gkeelrdz
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:24 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:38:24 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:38:24 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:24 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:38:24 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:24 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:24 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:38:24 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:38:24 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:38:24 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:38:24 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:25 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:38:25 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:38:25 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:38:25 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:25 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:38:25 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:26 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=gkeelrdz
2025-07-13 20:38:26 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=gkeelrdz
2025-07-13 20:38:26 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=gkeelrdz
2025-07-13 20:38:26 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:38:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:38:26 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:38:26 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:38:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:38:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:38:27 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:27 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:38:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:38:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:38:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:38:28 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:28 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:38:28 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:29 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=u52m4fbd
2025-07-13 20:38:29 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=u52m4fbd
2025-07-13 20:38:29 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=u52m4fbd
2025-07-13 20:38:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:38:30 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:38:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:38:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":"2 (truncated)..."]
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type `java.time.LocalDateTime` not supported by default: add Module "com.fasterxml.jackson.datatype:jackson-datatype-jsr310" to enable handling (or disable `MapperFeature.REQUIRE_HANDLERS_FOR_JAVA8_TIMES`)<EOL> at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 99] (through reference chain: com.btalk.dto.MessageDto["sentAt"])]
2025-07-13 20:38:34 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:39:10 [MessageBroker-12] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 36], outboundChannel[pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 14]
2025-07-13 20:40:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=u52m4fbd] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:40:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session u52m4fbd
2025-07-13 20:40:14 [http-nio-8080-exec-6] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:40:14 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=u52m4fbd
2025-07-13 20:40:14 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=u52m4fbd}], simpSessionId=u52m4fbd}]
2025-07-13 20:40:14 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=gkeelrdz] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:40:14 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session gkeelrdz
2025-07-13 20:40:14 [http-nio-8080-exec-10] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:40:14 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=gkeelrdz
2025-07-13 20:40:14 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=gkeelrdz}], simpSessionId=gkeelrdz}]
2025-07-13 20:40:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:14 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415814573", parameters={masked}
2025-07-13 20:40:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415814573
2025-07-13 20:40:14 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:40:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:14 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/917/h0oieljz/websocket", parameters={}
2025-07-13 20:40:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/917/h0oieljz/websocket
2025-07-13 20:40:14 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:40:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=h0oieljz]
2025-07-13 20:40:14 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:40:14 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=h0oieljz
2025-07-13 20:40:14 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=h0oieljz
2025-07-13 20:40:14 [clientInboundChannel-46] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=h0oieljz
2025-07-13 20:40:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:14 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415815058", parameters={masked}
2025-07-13 20:40:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415815058
2025-07-13 20:40:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/675/zf4hhzki/websocket", parameters={}
2025-07-13 20:40:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/675/zf4hhzki/websocket
2025-07-13 20:40:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:40:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zf4hhzki]
2025-07-13 20:40:15 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:40:15 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=zf4hhzki
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:15 [clientInboundChannel-52] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=zf4hhzki
2025-07-13 20:40:15 [clientInboundChannel-55] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=zf4hhzki
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:15 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:15 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:40:15 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=h0oieljz] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:40:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session h0oieljz
2025-07-13 20:40:16 [http-nio-8080-exec-2] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:40:16 [clientInboundChannel-58] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=h0oieljz
2025-07-13 20:40:16 [clientOutboundChannel-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=h0oieljz}], simpSessionId=h0oieljz}]
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zf4hhzki] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session zf4hhzki
2025-07-13 20:40:16 [http-nio-8080-exec-6] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:40:16 [clientInboundChannel-61] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=zf4hhzki
2025-07-13 20:40:16 [clientOutboundChannel-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=zf4hhzki}], simpSessionId=zf4hhzki}]
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:16 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415816344", parameters={masked}
2025-07-13 20:40:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415816344
2025-07-13 20:40:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:16 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/813/dhbvyhl4/websocket", parameters={}
2025-07-13 20:40:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/813/dhbvyhl4/websocket
2025-07-13 20:40:16 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:40:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=dhbvyhl4]
2025-07-13 20:40:16 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:40:16 [clientInboundChannel-64] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=dhbvyhl4
2025-07-13 20:40:16 [clientInboundChannel-35] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=dhbvyhl4
2025-07-13 20:40:16 [clientInboundChannel-35] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=dhbvyhl4
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415816723", parameters={masked}
2025-07-13 20:40:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415816723
2025-07-13 20:40:16 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/295/vxppsluw/websocket", parameters={}
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/295/vxppsluw/websocket
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:40:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=vxppsluw]
2025-07-13 20:40:16 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:40:16 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=vxppsluw
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:16 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=vxppsluw
2025-07-13 20:40:16 [clientInboundChannel-47] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=vxppsluw
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:16 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:16 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:40:16 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:17 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:17 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:17 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:17 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:40:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:40:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:40:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:19 [MessageBroker-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [u52m4fbd, gkeelrdz]
2025-07-13 20:40:21 [clientInboundChannel-50] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=vxppsluw
2025-07-13 20:40:21 [clientInboundChannel-50] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=vxppsluw
2025-07-13 20:40:21 [clientInboundChannel-55] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=vxppsluw
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:21 [clientInboundChannel-57] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=dhbvyhl4
2025-07-13 20:40:21 [clientInboundChannel-57] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=dhbvyhl4
2025-07-13 20:40:21 [clientInboundChannel-57] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=dhbvyhl4
2025-07-13 20:40:21 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:21 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:40:21 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:40:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:21 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:22 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:22 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:22 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:22 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:22 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:22 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:22 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:22 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:22 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:40:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:22 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:40:22 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:22 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:22 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:22 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:22 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:23 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:23 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:23 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:24 [MessageBroker-12] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [zf4hhzki, h0oieljz]
2025-07-13 20:40:28 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=vxppsluw
2025-07-13 20:40:28 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=vxppsluw
2025-07-13 20:40:28 [clientInboundChannel-42] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=vxppsluw
2025-07-13 20:40:28 [clientInboundChannel-45] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-6 session=vxppsluw
2025-07-13 20:40:28 [clientInboundChannel-47] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-7 session=vxppsluw
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:28 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=dhbvyhl4
2025-07-13 20:40:28 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=dhbvyhl4
2025-07-13 20:40:28 [clientInboundChannel-56] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=dhbvyhl4
2025-07-13 20:40:28 [clientInboundChannel-57] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-6 session=dhbvyhl4
2025-07-13 20:40:28 [clientInboundChannel-62] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-7 session=dhbvyhl4
2025-07-13 20:40:28 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:28 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:29 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:29 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:29 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:29 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:40:29 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:40:29 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:29 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:40:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:40:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:40:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:40:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":1,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":"2 (truncated)..."]
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type `java.time.LocalDateTime` not supported by default: add Module "com.fasterxml.jackson.datatype:jackson-datatype-jsr310" to enable handling (or disable `MapperFeature.REQUIRE_HANDLERS_FOR_JAVA8_TIMES`)<EOL> at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 99] (through reference chain: com.btalk.dto.MessageDto["sentAt"])]
2025-07-13 20:40:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:41:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=dhbvyhl4] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:41:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session dhbvyhl4
2025-07-13 20:41:28 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:41:28 [clientInboundChannel-66] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=dhbvyhl4
2025-07-13 20:41:28 [clientOutboundChannel-11] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=dhbvyhl4}], simpSessionId=dhbvyhl4}]
2025-07-13 20:41:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=vxppsluw] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:41:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session vxppsluw
2025-07-13 20:41:28 [http-nio-8080-exec-10] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:41:28 [clientInboundChannel-69] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=vxppsluw
2025-07-13 20:41:28 [clientOutboundChannel-12] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=vxppsluw}], simpSessionId=vxppsluw}]
2025-07-13 20:41:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:28 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415888779", parameters={masked}
2025-07-13 20:41:28 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:41:28 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415888779
2025-07-13 20:41:28 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/018/ck1ecqxo/websocket", parameters={}
2025-07-13 20:41:28 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:41:28 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/018/ck1ecqxo/websocket
2025-07-13 20:41:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:41:28 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ck1ecqxo]
2025-07-13 20:41:28 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:41:28 [clientInboundChannel-72] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ck1ecqxo
2025-07-13 20:41:28 [clientInboundChannel-75] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ck1ecqxo
2025-07-13 20:41:28 [clientInboundChannel-78] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ck1ecqxo
2025-07-13 20:41:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:28 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415888949", parameters={masked}
2025-07-13 20:41:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:41:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415888949
2025-07-13 20:41:28 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/197/ibwnokke/websocket", parameters={}
2025-07-13 20:41:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:41:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/197/ibwnokke/websocket
2025-07-13 20:41:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:41:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ibwnokke]
2025-07-13 20:41:28 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:41:28 [clientInboundChannel-81] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ibwnokke
2025-07-13 20:41:28 [clientInboundChannel-84] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ibwnokke
2025-07-13 20:41:28 [clientInboundChannel-87] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ibwnokke
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:41:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:41:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:41:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:41:30 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:41:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:41:30 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:41:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:41:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:41:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:41:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:31 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:32 [clientInboundChannel-90] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=ck1ecqxo
2025-07-13 20:41:32 [clientInboundChannel-93] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=ck1ecqxo
2025-07-13 20:41:32 [clientInboundChannel-96] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=ck1ecqxo
2025-07-13 20:41:32 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:41:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:41:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:41:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:41:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:41:34 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [dhbvyhl4, vxppsluw]
2025-07-13 20:41:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:41:34 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:34 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:41:34 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:41:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:41:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:41:35 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:35 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:41:35 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:41:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":"2 (truncated)..."]
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type `java.time.LocalDateTime` not supported by default: add Module "com.fasterxml.jackson.datatype:jackson-datatype-jsr310" to enable handling (or disable `MapperFeature.REQUIRE_HANDLERS_FOR_JAVA8_TIMES`)<EOL> at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 99] (through reference chain: com.btalk.dto.MessageDto["sentAt"])]
2025-07-13 20:41:36 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:42:17 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ck1ecqxo] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:42:17 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ck1ecqxo
2025-07-13 20:42:17 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:42:17 [clientInboundChannel-67] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ck1ecqxo
2025-07-13 20:42:17 [clientOutboundChannel-15] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=ck1ecqxo}], simpSessionId=ck1ecqxo}]
2025-07-13 20:42:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ibwnokke] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:42:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ibwnokke
2025-07-13 20:42:17 [http-nio-8080-exec-6] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:42:17 [clientInboundChannel-68] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ibwnokke
2025-07-13 20:42:17 [clientOutboundChannel-16] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=ibwnokke}], simpSessionId=ibwnokke}]
2025-07-13 20:42:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415937632", parameters={masked}
2025-07-13 20:42:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:42:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415937632
2025-07-13 20:42:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:17 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/004/rwsdvucv/websocket", parameters={}
2025-07-13 20:42:17 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:42:17 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/004/rwsdvucv/websocket
2025-07-13 20:42:17 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:42:17 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=rwsdvucv]
2025-07-13 20:42:17 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:42:17 [clientInboundChannel-73] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=rwsdvucv
2025-07-13 20:42:17 [clientInboundChannel-76] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=rwsdvucv
2025-07-13 20:42:17 [clientInboundChannel-76] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=rwsdvucv
2025-07-13 20:42:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:17 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:42:17 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:42:17 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415937851", parameters={masked}
2025-07-13 20:42:17 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:42:17 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415937851
2025-07-13 20:42:17 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/612/aedexfnq/websocket", parameters={}
2025-07-13 20:42:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:42:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/612/aedexfnq/websocket
2025-07-13 20:42:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:42:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=aedexfnq]
2025-07-13 20:42:17 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:42:17 [clientInboundChannel-82] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=aedexfnq
2025-07-13 20:42:17 [clientInboundChannel-84] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=aedexfnq
2025-07-13 20:42:17 [clientInboundChannel-88] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=aedexfnq
2025-07-13 20:42:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:42:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:42:18 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:18 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:42:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:42:19 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:19 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:42:19 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:42:19 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:42:19 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:20 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:20 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:42:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:24 [MessageBroker-11] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [ibwnokke, ck1ecqxo]
2025-07-13 20:42:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=aedexfnq] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:42:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session aedexfnq
2025-07-13 20:42:43 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:42:43 [clientInboundChannel-98] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=aedexfnq
2025-07-13 20:42:43 [clientOutboundChannel-19] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=aedexfnq}], simpSessionId=aedexfnq}]
2025-07-13 20:42:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:43 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752415963618", parameters={masked}
2025-07-13 20:42:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:42:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752415963618
2025-07-13 20:42:43 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/287/bmtqfniw/websocket", parameters={}
2025-07-13 20:42:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@72a90036
2025-07-13 20:42:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/287/bmtqfniw/websocket
2025-07-13 20:42:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:42:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=bmtqfniw]
2025-07-13 20:42:43 [http-nio-8080-exec-7] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:42:43 [clientInboundChannel-101] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=bmtqfniw
2025-07-13 20:42:43 [clientInboundChannel-104] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=bmtqfniw
2025-07-13 20:42:43 [clientInboundChannel-107] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=bmtqfniw
2025-07-13 20:42:43 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:42:43 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:42:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:42:44 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:44 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:42:44 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:42:45 [clientInboundChannel-110] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=bmtqfniw
2025-07-13 20:42:45 [clientInboundChannel-113] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=bmtqfniw
2025-07-13 20:42:45 [clientInboundChannel-66] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=bmtqfniw
2025-07-13 20:42:45 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:42:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:45 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:42:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:46 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:46 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:46 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:46 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:46 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:46 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:42:46 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:47 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:47 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:47 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:49 [MessageBroker-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [aedexfnq]
2025-07-13 20:42:52 [clientInboundChannel-69] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=rwsdvucv
2025-07-13 20:42:52 [clientInboundChannel-69] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=rwsdvucv
2025-07-13 20:42:52 [clientInboundChannel-82] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=rwsdvucv
2025-07-13 20:42:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:52 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:42:52 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:53 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:53 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:42:53 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:53 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:53 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:53 [clientInboundChannel-88] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=bmtqfniw
2025-07-13 20:42:53 [clientInboundChannel-88] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=bmtqfniw
2025-07-13 20:42:53 [clientInboundChannel-101] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=bmtqfniw
2025-07-13 20:42:53 [clientInboundChannel-101] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-6 session=bmtqfniw
2025-07-13 20:42:53 [clientInboundChannel-108] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-7 session=bmtqfniw
2025-07-13 20:42:53 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:54 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:54 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:54 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:54 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:42:54 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:54 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:55 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:55 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:42:55 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:42:55 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:55 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:42:56 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:56 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:42:56 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:42:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:42:57 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:42:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:42:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":1,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 20:42:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:42:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/12/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=43, conversat (truncated)...]
2025-07-13 20:42:58 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:43:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:43:04 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:43:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:43:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":1,"content":"how are you","messageType":"TEXT","status":"SENT","sent (truncated)..."]
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/12/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=44, conversat (truncated)...]
2025-07-13 20:43:05 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:43:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:43:09 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:43:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:43:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"Woo","messageType":"TEXT","status":"SENT","sentAt":null (truncated)..."]
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/12/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=45, conversat (truncated)...]
2025-07-13 20:43:10 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"No body like us","messageType":"TEXT","status":"SENT"," (truncated)..."]
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:43:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:43:16 [http-nio-8080-exec-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/12/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:43:16 [http-nio-8080-exec-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:43:16 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:43:16 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=46, conversat (truncated)...]
2025-07-13 20:43:16 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:43:24 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `com.btalk.constants.MessageType` from String "MEDIA": not one of the values accepted for Enum class: [IMAGE, TEXT, AUDIO, VIDEO]<EOL> at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 62] (through reference chain: com.btalk.dto.MessageDto["messageType"])]
2025-07-13 20:43:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `com.btalk.constants.MessageType` from String "MEDIA": not one of the values accepted for Enum class: [IMAGE, TEXT, AUDIO, VIDEO]<EOL> at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 62] (through reference chain: com.btalk.dto.MessageDto["messageType"])]
2025-07-13 20:43:27 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 20:44:16 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session rwsdvucv with CloseStatus[code=1001, reason=null]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=rwsdvucv]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=rwsdvucv] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session rwsdvucv
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session bmtqfniw with CloseStatus[code=1001, reason=null]
2025-07-13 20:44:16 [clientInboundChannel-117] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=rwsdvucv
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=bmtqfniw]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=bmtqfniw] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session bmtqfniw
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:44:16 [clientInboundChannel-120] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=bmtqfniw
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21ec7946]]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21ec7946]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21ec7946]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:44:16 [RMI TCP Connection(8)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 20:44:17 [RMI TCP Connection(8)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 20:44:19 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 31680 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:44:19 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:44:19 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:44:19 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 103 ms. Found 6 JPA repository interfaces.
2025-07-13 20:44:20 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:44:20 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:44:20 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:44:20 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:44:20 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1572 ms
2025-07-13 20:44:20 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:44:20 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:44:20 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:44:21 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:44:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:44:22 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@77eb607e
2025-07-13 20:44:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:44:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:44:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:44:22 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:44:23 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:44:24 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:44:24 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:44:25 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:44:25 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 20:44:25 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 20:44:25 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-07-13 20:44:25 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileController:
	
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 20:44:26 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 20:44:26 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:44:26 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:44:26 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 20:44:26 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1f600254]
2025-07-13 20:44:26 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1f600254]
2025-07-13 20:44:26 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1f600254]]
2025-07-13 20:44:26 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 20:44:26 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:44:26 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:44:26 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 20:44:26 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 7.881 seconds (process running for 8.425)
2025-07-13 20:44:35 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 20:44:35 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 20:44:35 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 20:44:35 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 20:44:35 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 20:44:35 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@1acf0703
2025-07-13 20:44:35 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@6d618003
2025-07-13 20:44:35 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 20:44:35 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-13 20:44:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:44:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:44:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:44:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:44:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:44:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:44:36 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1265, SQLState: 01000
2025-07-13 20:44:36 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Data truncated for column 'message_type' at row 1
2025-07-13 20:44:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.btalk.exceptions.CustomExceptionHandler#handleGeneralException(Exception)
2025-07-13 20:44:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:44:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(success=false, message=An unexpected error occurred, data=null)]
2025-07-13 20:44:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.orm.jpa.JpaSystemException: could not execute statement [Data truncated for column 'message_type' at row 1] [insert into messages (content,conversation_id,message_type,sender_id,sent_at) values (?,?,?,?,?)]]
2025-07-13 20:44:37 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-07-13 20:45:26 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-07-13 20:47:04 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:05 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:06 [http-nio-8080-exec-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/12/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 20:47:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=47, conversat (truncated)...]
2025-07-13 20:47:06 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:10 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:10 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416230959", parameters={masked}
2025-07-13 20:47:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@5c8ba2ed
2025-07-13 20:47:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416230959
2025-07-13 20:47:10 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/799/ex454gko/websocket", parameters={}
2025-07-13 20:47:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@5c8ba2ed
2025-07-13 20:47:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/799/ex454gko/websocket
2025-07-13 20:47:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:47:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ex454gko]
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:47:11 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:47:11 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ex454gko
2025-07-13 20:47:11 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ex454gko
2025-07-13 20:47:11 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ex454gko
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:47:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:47:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:47:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:47:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:47:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:47:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:16 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=ex454gko
2025-07-13 20:47:16 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=ex454gko
2025-07-13 20:47:16 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=ex454gko
2025-07-13 20:47:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:16 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:47:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:17 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:47:17 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:18 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:18 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:18 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:18 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:18 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:18 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=1", parameters={masked}
2025-07-13 20:47:18 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:18 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:18 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:18 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:19 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:19 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:19 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:37 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 20:47:37 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 20:47:38 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session ex454gko with CloseStatus[code=1001, reason=null]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=ex454gko]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ex454gko] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ex454gko
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:47:38 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ex454gko
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1f600254]]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1f600254]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1f600254]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 20:47:38 [RMI TCP Connection(7)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 20:47:40 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 39472 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:47:40 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:47:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:47:41 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 62 ms. Found 6 JPA repository interfaces.
2025-07-13 20:47:41 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:47:41 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:47:41 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:47:41 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:47:41 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1385 ms
2025-07-13 20:47:41 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:47:41 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:47:41 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:47:42 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:47:42 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:47:43 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@65ef9a0a
2025-07-13 20:47:43 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:47:43 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:47:43 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:47:43 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:47:44 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:47:45 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:47:45 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:47:46 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:47:46 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 20:47:46 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileController:
	
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 20:47:47 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 20:47:47 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:47:47 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:47:47 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 20:47:47 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@13d7410a]
2025-07-13 20:47:47 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@13d7410a]
2025-07-13 20:47:47 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@13d7410a]]
2025-07-13 20:47:47 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 20:47:47 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:47:47 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:47:47 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 20:47:47 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 7.637 seconds (process running for 8.246)
2025-07-13 20:47:53 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 20:47:53 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6fefa622
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@694adaac
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 20:47:53 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416273001", parameters={masked}
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@145baec6
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416273001
2025-07-13 20:47:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:53 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/813/m1n0z1nz/websocket", parameters={}
2025-07-13 20:47:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@145baec6
2025-07-13 20:47:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/813/m1n0z1nz/websocket
2025-07-13 20:47:53 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:47:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=m1n0z1nz]
2025-07-13 20:47:53 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:47:53 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=m1n0z1nz
2025-07-13 20:47:53 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=m1n0z1nz
2025-07-13 20:47:53 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=m1n0z1nz
2025-07-13 20:47:53 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:53 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:47:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:47:53 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:47:53 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:47:53 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:47:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:54 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:54 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:47:54 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:47:55 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=m1n0z1nz
2025-07-13 20:47:55 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-3 session=m1n0z1nz
2025-07-13 20:47:55 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-4 session=m1n0z1nz
2025-07-13 20:47:55 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:47:55 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:47:55 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:55 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:55 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:56 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:56 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:47:56 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:56 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:56 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:56 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:47:56 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:56 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:56 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:57 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:57 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:57 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=m1n0z1nz
2025-07-13 20:47:57 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=m1n0z1nz
2025-07-13 20:47:57 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=m1n0z1nz
2025-07-13 20:47:57 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-6 session=m1n0z1nz
2025-07-13 20:47:57 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/12/messages id=sub-7 session=m1n0z1nz
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:57 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:58 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:58 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:47:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:47:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:47:59 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:47:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:48:00 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:48:00 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:48:00 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/12?userId=2", parameters={masked}
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=47, co (truncated)...]
2025-07-13 20:48:00 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:48:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:48:14 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:48:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:48:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":12,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:48:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:48:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/12/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 1 sessions.
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=48, conversat (truncated)...]
2025-07-13 20:48:15 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:48:47 [MessageBroker-4] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 33], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 2, completed tasks = 12]
2025-07-13 20:51:14 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 20:51:14 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 20:51:15 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session m1n0z1nz with CloseStatus[code=1001, reason=null]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=m1n0z1nz]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=m1n0z1nz] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session m1n0z1nz
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:51:15 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=m1n0z1nz
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@13d7410a]]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@13d7410a]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@13d7410a]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 20:51:15 [RMI TCP Connection(7)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 20:51:17 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 32932 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:51:17 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:51:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:51:18 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 121 ms. Found 6 JPA repository interfaces.
2025-07-13 20:51:18 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:51:18 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:51:18 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:51:18 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:51:18 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1647 ms
2025-07-13 20:51:18 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:51:19 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:51:19 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:51:19 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:51:19 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:51:20 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@42a05533
2025-07-13 20:51:20 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:51:20 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:51:20 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:51:21 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:51:22 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:51:22 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:51:22 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:51:23 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:51:24 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileController:
	
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 20:51:24 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 20:51:25 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:51:25 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:51:25 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 20:51:25 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a99f50e]
2025-07-13 20:51:25 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a99f50e]
2025-07-13 20:51:25 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a99f50e]]
2025-07-13 20:51:25 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 20:51:25 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:51:25 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:51:25 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 20:51:25 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 8.491 seconds (process running for 9.045)
2025-07-13 20:51:25 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 20:51:25 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 20:51:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 20:51:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 20:51:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 20:51:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@61df99e6
2025-07-13 20:51:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@17dee9f9
2025-07-13 20:51:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 20:51:25 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 7 ms
2025-07-13 20:51:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416485480", parameters={masked}
2025-07-13 20:51:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416484373", parameters={masked}
2025-07-13 20:51:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@76da91cf
2025-07-13 20:51:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@76da91cf
2025-07-13 20:51:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416484373
2025-07-13 20:51:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416485480
2025-07-13 20:51:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:25 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/230/0h1pe5kw/websocket", parameters={}
2025-07-13 20:51:25 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/756/owrt5mfn/websocket", parameters={}
2025-07-13 20:51:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@76da91cf
2025-07-13 20:51:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@76da91cf
2025-07-13 20:51:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/756/owrt5mfn/websocket
2025-07-13 20:51:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/230/0h1pe5kw/websocket
2025-07-13 20:51:25 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:51:25 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:51:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=0h1pe5kw]
2025-07-13 20:51:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=owrt5mfn]
2025-07-13 20:51:25 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:51:25 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:51:25 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=0h1pe5kw
2025-07-13 20:51:25 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=owrt5mfn
2025-07-13 20:51:25 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=0h1pe5kw
2025-07-13 20:51:25 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=owrt5mfn
2025-07-13 20:51:25 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=0h1pe5kw
2025-07-13 20:51:25 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=owrt5mfn
2025-07-13 20:51:25 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:25 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:26 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:51:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:51:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:51:26 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:51:26 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:51:26 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:51:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:26 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:26 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[])]
2025-07-13 20:51:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[])]
2025-07-13 20:51:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:26 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:26 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:26 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:27 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:51:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:51:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:51:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:51:27 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:51:27 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:51:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[])]
2025-07-13 20:51:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[])]
2025-07-13 20:51:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:27 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/users/search?query=Thaw", parameters={masked}
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.UserController#searchUsers(String)
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.name like replace(?, '\\', '\\\\')
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Users retrieved successfully, data=[UserDto(userId=1, phoneNumber= (truncated)...]
2025-07-13 20:51:32 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:33 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/users/search?query=Htin", parameters={masked}
2025-07-13 20:51:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.UserController#searchUsers(String)
2025-07-13 20:51:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.name like replace(?, '\\', '\\\\')
2025-07-13 20:51:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Users retrieved successfully, data=[UserDto(userId=1, phoneNumber= (truncated)...]
2025-07-13 20:51:34 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/conversations/private?creatorId=1&participantId=2", parameters={masked}
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#createPrivateConversation(Long, Long)
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    where
        c1_0.type='PRIVATE' 
        and exists(select
            p1_0.participant_id 
        from
            participants p1_0 
        where
            p1_0.conversation_id=c1_0.conversation_id 
            and p1_0.user_id=?) 
        and exists(select
            p2_0.participant_id 
        from
            participants p2_0 
        where
            p2_0.conversation_id=c1_0.conversation_id 
            and p2_0.user_id=?)
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        conversations
        (created_at, creator_id, name, type) 
    values
        (?, ?, ?, ?)
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        participants
        (conversation_id, joined_at, left_at, user_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        participants
        (conversation_id, joined_at, left_at, user_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:51:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:51:37 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:37 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Private conversation created successfully, data=ConversationDto(co (truncated)...]
2025-07-13 20:51:37 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:51:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:51:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:51:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:51:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:51:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:51:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:51:38 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/users/search?query=Thaw", parameters={masked}
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.UserController#searchUsers(String)
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.name like replace(?, '\\', '\\\\')
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Users retrieved successfully, data=[UserDto(userId=1, phoneNumber= (truncated)...]
2025-07-13 20:51:46 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/conversations/private?creatorId=2&participantId=1", parameters={masked}
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#createPrivateConversation(Long, Long)
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    where
        c1_0.type='PRIVATE' 
        and exists(select
            p1_0.participant_id 
        from
            participants p1_0 
        where
            p1_0.conversation_id=c1_0.conversation_id 
            and p1_0.user_id=?) 
        and exists(select
            p2_0.participant_id 
        from
            participants p2_0 
        where
            p2_0.conversation_id=c1_0.conversation_id 
            and p2_0.user_id=?)
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:48 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:51:49 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:51:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Private conversation created successfully, data=ConversationDto(co (truncated)...]
2025-07-13 20:51:49 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:49 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:50 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:51:50 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:51:50 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:50 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:51:50 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:51 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=0h1pe5kw
2025-07-13 20:51:51 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=0h1pe5kw
2025-07-13 20:51:51 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=0h1pe5kw
2025-07-13 20:51:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:51 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:51:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:52 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=0h1pe5kw
2025-07-13 20:51:52 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=0h1pe5kw
2025-07-13 20:51:52 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=0h1pe5kw
2025-07-13 20:51:52 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=0h1pe5kw
2025-07-13 20:51:52 [clientInboundChannel-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=0h1pe5kw
2025-07-13 20:51:52 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:52 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:51:52 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:51:52 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:52 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:51:53 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:51:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:51:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:54 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:54 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:51:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:54 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:54 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:51:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:51:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:55 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:55 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:51:55 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 1 sessions.
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=49, conversat (truncated)...]
2025-07-13 20:51:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:57 [clientInboundChannel-13] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=owrt5mfn
2025-07-13 20:51:57 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=owrt5mfn
2025-07-13 20:51:57 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=owrt5mfn
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:57 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:51:58 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:58 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=49, co (truncated)...]
2025-07-13 20:51:58 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=49, co (truncated)...]
2025-07-13 20:51:58 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:51:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=49, co (truncated)...]
2025-07-13 20:51:59 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:52:01 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"What up","messageType":"TEXT","status":"SENT","sentAt": (truncated)..."]
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=50, conversat (truncated)...]
2025-07-13 20:52:02 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:52:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:52:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:52:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:52:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:52:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:52:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=51, conversat (truncated)...]
2025-07-13 20:52:13 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:52:25 [MessageBroker-11] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 51], outboundChannel[pool size = 15, active threads = 0, queued tasks = 0, completed tasks = 15], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 14]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 20:53:01 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session 0h1pe5kw with CloseStatus[code=1001, reason=null]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=0h1pe5kw]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=0h1pe5kw] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 0h1pe5kw
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:53:01 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=0h1pe5kw
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session owrt5mfn with CloseStatus[code=1001, reason=null]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=owrt5mfn]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=owrt5mfn] closed with CloseStatus[code=1001, reason=null]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session owrt5mfn
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:53:01 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=owrt5mfn
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a99f50e]]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a99f50e]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a99f50e]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 20:53:01 [RMI TCP Connection(5)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 20:53:04 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 15132 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 20:53:04 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 20:53:04 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 20:53:04 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 72 ms. Found 6 JPA repository interfaces.
2025-07-13 20:53:05 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 20:53:05 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 20:53:05 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 20:53:05 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 20:53:05 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1360 ms
2025-07-13 20:53:05 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 20:53:05 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 20:53:05 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 20:53:06 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 20:53:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 20:53:07 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6d31f14
2025-07-13 20:53:07 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 20:53:07 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 20:53:07 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 20:53:07 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 20:53:08 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 20:53:09 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 20:53:09 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 20:53:10 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 20:53:10 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileController:
	
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 20:53:11 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 20:53:11 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 20:53:11 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 20:53:11 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 20:53:11 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1962f55]
2025-07-13 20:53:11 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1962f55]
2025-07-13 20:53:11 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1962f55]]
2025-07-13 20:53:11 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 20:53:11 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:53:11 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 20:53:11 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 20:53:11 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 8.263 seconds (process running for 9.033)
2025-07-13 20:53:43 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 20:53:43 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 20:53:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 20:53:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 20:53:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 20:53:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4e0e9fc1
2025-07-13 20:53:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@28f74096
2025-07-13 20:53:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 20:53:43 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-07-13 20:53:44 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:53:44 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:53:44 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:53:44 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:53:44 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:53:44 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=52, conversat (truncated)...]
2025-07-13 20:53:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:54:11 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-07-13 20:55:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:45 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416745389", parameters={masked}
2025-07-13 20:55:45 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:55:45 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416745389
2025-07-13 20:55:45 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:45 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/057/sttwp3dq/websocket", parameters={}
2025-07-13 20:55:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:55:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/057/sttwp3dq/websocket
2025-07-13 20:55:45 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:55:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=sttwp3dq]
2025-07-13 20:55:45 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:55:45 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=sttwp3dq
2025-07-13 20:55:45 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=sttwp3dq
2025-07-13 20:55:45 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=sttwp3dq
2025-07-13 20:55:45 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:55:45 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:55:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416745709", parameters={masked}
2025-07-13 20:55:45 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:55:45 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416745709
2025-07-13 20:55:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/072/2soayq4a/websocket", parameters={}
2025-07-13 20:55:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:55:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/072/2soayq4a/websocket
2025-07-13 20:55:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:55:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=2soayq4a]
2025-07-13 20:55:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:55:45 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:55:45 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=2soayq4a
2025-07-13 20:55:45 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=2soayq4a
2025-07-13 20:55:45 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=2soayq4a
2025-07-13 20:55:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:55:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:55:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:55:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:55:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:55:46 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:46 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:55:46 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:46 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:55:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:55:46 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:46 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:55:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:55:47 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:53 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=sttwp3dq
2025-07-13 20:55:53 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=sttwp3dq
2025-07-13 20:55:53 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=sttwp3dq
2025-07-13 20:55:53 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:55:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:54 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:54 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:55:54 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:55:54 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:54 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:55:54 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=2soayq4a
2025-07-13 20:55:54 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=2soayq4a
2025-07-13 20:55:54 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=2soayq4a
2025-07-13 20:55:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:55:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:55:55 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:55:55 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:55 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:55 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:55:55 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:55:55 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:55 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:56 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:55:56 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:56 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:55:56 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:55:56 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:55:56 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:55:56 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:55:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:55:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":1,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 20:55:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:55:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:55:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:55:57 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:57 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 20:55:57 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=53, conversat (truncated)...]
2025-07-13 20:55:57 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":1,"content":"It is me","messageType":"TEXT","status":"SENT","sentAt" (truncated)..."]
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:56:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:05 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:56:05 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:56:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=54, conversat (truncated)...]
2025-07-13 20:56:05 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:11 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:56:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:56:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"","messageType":"MEDIA","status":"SENT","sentAt":null," (truncated)..."]
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=55, conversat (truncated)...]
2025-07-13 20:56:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=2soayq4a] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:56:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 2soayq4a
2025-07-13 20:56:19 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:56:19 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=2soayq4a
2025-07-13 20:56:19 [clientOutboundChannel-15] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=2soayq4a}], simpSessionId=2soayq4a}]
2025-07-13 20:56:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=sttwp3dq] closed with CloseStatus[code=1000, reason=null]
2025-07-13 20:56:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session sttwp3dq
2025-07-13 20:56:19 [http-nio-8080-exec-2] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 20:56:19 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=sttwp3dq
2025-07-13 20:56:19 [clientOutboundChannel-16] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=sttwp3dq}], simpSessionId=sttwp3dq}]
2025-07-13 20:56:19 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:20 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416780017", parameters={masked}
2025-07-13 20:56:20 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:56:20 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416780017
2025-07-13 20:56:20 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:20 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/541/muz0k2xz/websocket", parameters={}
2025-07-13 20:56:20 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:56:20 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/541/muz0k2xz/websocket
2025-07-13 20:56:20 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:56:20 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=muz0k2xz]
2025-07-13 20:56:20 [http-nio-8080-exec-1] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 20:56:20 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=muz0k2xz
2025-07-13 20:56:20 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=muz0k2xz
2025-07-13 20:56:20 [clientInboundChannel-18] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=muz0k2xz
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752416780413", parameters={masked}
2025-07-13 20:56:20 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:56:20 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752416780413
2025-07-13 20:56:20 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/154/pf3ld20q/websocket", parameters={}
2025-07-13 20:56:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 20:56:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/154/pf3ld20q/websocket
2025-07-13 20:56:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 20:56:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=pf3ld20q]
2025-07-13 20:56:20 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 20:56:20 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=pf3ld20q
2025-07-13 20:56:20 [clientInboundChannel-24] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=pf3ld20q
2025-07-13 20:56:20 [clientInboundChannel-27] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=pf3ld20q
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:56:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:56:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:56:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:21 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 20:56:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 20:56:21 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:56:21 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:22 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:22 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:22 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:22 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:56:22 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 20:56:22 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:23 [clientInboundChannel-30] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=pf3ld20q
2025-07-13 20:56:23 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=pf3ld20q
2025-07-13 20:56:23 [clientInboundChannel-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=pf3ld20q
2025-07-13 20:56:23 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:24 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:25 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:25 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:25 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:25 [MessageBroker-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [sttwp3dq, 2soayq4a]
2025-07-13 20:56:25 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:25 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:25 [clientInboundChannel-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=pf3ld20q
2025-07-13 20:56:25 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=pf3ld20q
2025-07-13 20:56:25 [clientInboundChannel-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=pf3ld20q
2025-07-13 20:56:25 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=pf3ld20q
2025-07-13 20:56:25 [clientInboundChannel-18] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=pf3ld20q
2025-07-13 20:56:25 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:25 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:26 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:26 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:28 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=muz0k2xz
2025-07-13 20:56:28 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=muz0k2xz
2025-07-13 20:56:28 [clientInboundChannel-28] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=muz0k2xz
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:28 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:30 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:30 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:30 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:30 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:30 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:31 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=muz0k2xz
2025-07-13 20:56:31 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=muz0k2xz
2025-07-13 20:56:31 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=muz0k2xz
2025-07-13 20:56:31 [clientInboundChannel-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=muz0k2xz
2025-07-13 20:56:31 [clientInboundChannel-12] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=muz0k2xz
2025-07-13 20:56:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:32 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-5 session=pf3ld20q
2025-07-13 20:56:32 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-6 session=pf3ld20q
2025-07-13 20:56:32 [clientInboundChannel-19] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-8 session=pf3ld20q
2025-07-13 20:56:32 [clientInboundChannel-25] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-9 session=pf3ld20q
2025-07-13 20:56:32 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-10 session=pf3ld20q
2025-07-13 20:56:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:32 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:32 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:32 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:32 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:32 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:32 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:33 [clientInboundChannel-1] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-8 session=pf3ld20q
2025-07-13 20:56:33 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-9 session=pf3ld20q
2025-07-13 20:56:33 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-11 session=pf3ld20q
2025-07-13 20:56:33 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-12 session=pf3ld20q
2025-07-13 20:56:33 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-13 session=pf3ld20q
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:33 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:33 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:34 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:34 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:35 [clientInboundChannel-13] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-11 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-16] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-12 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-14 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-19] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-15 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-16 session=pf3ld20q
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:35 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-14 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-15 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-17 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-18 session=pf3ld20q
2025-07-13 20:56:35 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-19 session=pf3ld20q
2025-07-13 20:56:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:36 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:37 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-17 session=pf3ld20q
2025-07-13 20:56:37 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-18 session=pf3ld20q
2025-07-13 20:56:37 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-20 session=pf3ld20q
2025-07-13 20:56:37 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-21 session=pf3ld20q
2025-07-13 20:56:37 [clientInboundChannel-24] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-22 session=pf3ld20q
2025-07-13 20:56:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:37 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:37 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:38 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:39 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:41 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:41 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:41 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:41 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:42 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:42 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:42 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:42 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:42 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:42 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:43 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:43 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:43 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:43 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:44 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=55, co (truncated)...]
2025-07-13 20:56:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":1,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:48 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:56:48 [http-nio-8080-exec-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:56:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=56, conversat (truncated)...]
2025-07-13 20:56:48 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"What up","messageType":"TEXT","status":"SENT","sentAt": (truncated)..."]
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:54 [http-nio-8080-exec-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 20:56:54 [http-nio-8080-exec-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 20:56:54 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:54 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=57, conversat (truncated)...]
2025-07-13 20:56:54 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:55 [clientInboundChannel-25] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-5 session=muz0k2xz
2025-07-13 20:56:55 [clientInboundChannel-1] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-6 session=muz0k2xz
2025-07-13 20:56:55 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-8 session=muz0k2xz
2025-07-13 20:56:55 [clientInboundChannel-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-9 session=muz0k2xz
2025-07-13 20:56:55 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-10 session=muz0k2xz
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:56:56 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:56 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:57 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-8 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-13] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-11 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-12 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-9 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-13 session=muz0k2xz
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:57 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-11 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-25] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-12 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-15 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-14 session=muz0k2xz
2025-07-13 20:56:57 [clientInboundChannel-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-16 session=muz0k2xz
2025-07-13 20:56:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:58 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:58 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:56:58 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:56:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:56:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:56:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:56:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:56:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:56:59 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:56:59 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:00 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-14 session=muz0k2xz
2025-07-13 20:57:00 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-15 session=muz0k2xz
2025-07-13 20:57:00 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-17 session=muz0k2xz
2025-07-13 20:57:00 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-18 session=muz0k2xz
2025-07-13 20:57:00 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-19 session=muz0k2xz
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:01 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:01 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:01 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:01 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:02 [clientInboundChannel-19] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-17 session=muz0k2xz
2025-07-13 20:57:02 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-18 session=muz0k2xz
2025-07-13 20:57:02 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-20 session=muz0k2xz
2025-07-13 20:57:02 [clientInboundChannel-25] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-21 session=muz0k2xz
2025-07-13 20:57:02 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-22 session=muz0k2xz
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:02 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:02 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:02 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:02 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:07 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:07 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:07 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:07 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:08 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-20 session=pf3ld20q
2025-07-13 20:57:08 [clientInboundChannel-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-21 session=pf3ld20q
2025-07-13 20:57:08 [clientInboundChannel-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-23 session=pf3ld20q
2025-07-13 20:57:08 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-24 session=pf3ld20q
2025-07-13 20:57:08 [clientInboundChannel-16] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-25 session=pf3ld20q
2025-07-13 20:57:08 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:08 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:57:08 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:08 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:08 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:08 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:08 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-23 session=pf3ld20q
2025-07-13 20:57:09 [clientInboundChannel-24] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-24 session=pf3ld20q
2025-07-13 20:57:09 [clientInboundChannel-24] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-26 session=pf3ld20q
2025-07-13 20:57:09 [clientInboundChannel-24] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-27 session=pf3ld20q
2025-07-13 20:57:09 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-28 session=pf3ld20q
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:10 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:10 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:10 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:11 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:11 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:11 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:57:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:11 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:11 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:11 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:11 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:14 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 20:57:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 20:57:14 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 20:57:15 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:08:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=pf3ld20q] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:08:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session pf3ld20q
2025-07-13 21:08:53 [http-nio-8080-exec-2] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:08:53 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=pf3ld20q
2025-07-13 21:08:53 [clientOutboundChannel-35] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=pf3ld20q}], simpSessionId=pf3ld20q}]
2025-07-13 21:08:53 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:08:53 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752417533684", parameters={masked}
2025-07-13 21:08:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 21:08:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752417533684
2025-07-13 21:08:53 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:08:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/637/5izlrmwx/websocket", parameters={}
2025-07-13 21:08:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@10990a32
2025-07-13 21:08:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/637/5izlrmwx/websocket
2025-07-13 21:08:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:08:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=5izlrmwx]
2025-07-13 21:08:53 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:08:53 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=5izlrmwx
2025-07-13 21:08:53 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=5izlrmwx
2025-07-13 21:08:53 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=5izlrmwx
2025-07-13 21:08:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:08:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:08:53 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:08:54 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:08:54 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:08:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:08:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:08:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:08:56 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:09:00 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [pf3ld20q]
2025-07-13 21:12:04 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3ef9abe5 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:12:14 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@6d31f14 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:12:24 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2476e70a (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:12:34 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7fc594de (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:12:34 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=56s243ms530s500ns).
2025-07-13 21:12:44 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@25b68b46 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:12:54 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@254e1023 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:13:04 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5994c408 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:13:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=5izlrmwx] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:13:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 5izlrmwx
2025-07-13 21:13:13 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:13:13 [clientInboundChannel-46] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=5izlrmwx
2025-07-13 21:13:13 [clientOutboundChannel-37] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=5izlrmwx}], simpSessionId=5izlrmwx}]
2025-07-13 21:13:15 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=muz0k2xz] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:13:15 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session muz0k2xz
2025-07-13 21:13:15 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:13:15 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=muz0k2xz
2025-07-13 21:13:15 [clientOutboundChannel-38] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=muz0k2xz}], simpSessionId=muz0k2xz}]
2025-07-13 21:13:20 [MessageBroker-15] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [5izlrmwx]
2025-07-13 21:13:25 [MessageBroker-15] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [muz0k2xz]
2025-07-13 21:13:25 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@a3c0e9a (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:13:35 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@71cdda23 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:13:46 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@72329f63 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:14:10 [HikariPool-1:connection-adder] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Pool is empty, failed to create/setup connection (b84b3386-1038-43fe-8e70-19ab24ae31b8)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:829)
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:449)
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:242)
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:198)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:139)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:368)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:205)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:483)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:747)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:726)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:89)
	at com.mysql.cj.NativeSession.connect(NativeSession.java:120)
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:949)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819)
	... 13 common frames omitted
Caused by: java.net.ConnectException: Connection timed out: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:156)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63)
	... 16 common frames omitted
2025-07-13 21:14:56 [RMI TCP Connection(26)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 21:14:56 [RMI TCP Connection(26)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 21:14:57 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1962f55]]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1962f55]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1962f55]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 21:14:57 [RMI TCP Connection(26)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 21:15:16 [HikariPool-1:connection-adder] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Pool is empty, failed to create/setup connection (ce0aa013-2d91-49b0-99df-bdbc88d639bd)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:829)
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:449)
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:242)
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:198)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:139)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:368)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:205)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:483)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:747)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:726)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at jdk.internal.reflect.GeneratedConstructorAccessor56.newInstance(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:89)
	at com.mysql.cj.NativeSession.connect(NativeSession.java:120)
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:949)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819)
	... 13 common frames omitted
Caused by: java.net.ConnectException: Connection timed out: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:156)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63)
	... 16 common frames omitted
2025-07-13 21:15:18 [RMI TCP Connection(26)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 21:15:20 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 34808 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 21:15:20 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 21:15:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 21:15:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 117 ms. Found 6 JPA repository interfaces.
2025-07-13 21:15:22 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 21:15:22 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 21:15:22 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 21:15:22 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 21:15:22 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1562 ms
2025-07-13 21:15:22 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 21:15:22 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 21:15:22 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 21:15:22 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 21:15:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 21:15:45 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 08S01
2025-07-13 21:15:45 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
2025-07-13 21:15:45 [main] WARN  o.h.e.j.e.i.JdbcEnvironmentInitiator - HHH000342: Could not obtain connection to query metadata
org.hibernate.exception.JDBCConnectionException: unable to obtain isolated JDBC connection [Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.] [n/a]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:100)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:116)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:336)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:129)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:81)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:130)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:226)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:194)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:171)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1442)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1513)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:691)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:513)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1725)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1474)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1683)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1628)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:913)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:240)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1395)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1232)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:230)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:184)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:179)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:164)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:96)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:271)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:245)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4464)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:621)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.btalk.BackendApplication.main(BackendApplication.java:10)
Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:829)
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:449)
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:242)
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:198)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:139)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:368)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:205)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:483)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:571)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:101)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:111)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:126)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:483)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:61)
	... 106 common frames omitted
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:89)
	at com.mysql.cj.NativeSession.connect(NativeSession.java:120)
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:949)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819)
	... 119 common frames omitted
Caused by: java.net.ConnectException: Connection timed out: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:156)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63)
	... 122 common frames omitted
2025-07-13 21:15:45 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 21:15:45 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 21:15:45 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (null)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 21:15:46 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 21:15:46 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 21:16:08 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 08S01
2025-07-13 21:16:08 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
2025-07-13 21:16:08 [main] ERROR o.s.o.j.LocalContainerEntityManagerFactoryBean - Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.] [n/a]
2025-07-13 21:16:08 [main] ERROR o.s.b.w.e.tomcat.TomcatStarter - Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name 'jwtAuthenticationFilter' defined in file [C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes\com\btalk\security\JwtAuthenticationFilter.class]: Unsatisfied dependency expressed through constructor parameter 1: Error creating bean with name 'userRepository' defined in com.btalk.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
2025-07-13 21:16:08 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-07-13 21:16:08 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-07-13 21:16:08 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-07-13 21:16:08 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:170)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:621)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.btalk.BackendApplication.main(BackendApplication.java:10)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:147)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'jwtAuthenticationFilter' defined in file [C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes\com\btalk\security\JwtAuthenticationFilter.class]: Unsatisfied dependency expressed through constructor parameter 1: Error creating bean with name 'userRepository' defined in com.btalk.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:804)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:240)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1395)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1232)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:230)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:184)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:179)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:164)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:96)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:271)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:245)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4464)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	... 13 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userRepository' defined in com.btalk.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1725)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1474)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1683)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1628)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:913)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	... 54 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jpaSharedEM_entityManagerFactory': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:691)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:513)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 67 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.] [n/a]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1826)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 79 common frames omitted
Caused by: jakarta.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.] [n/a]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:431)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	... 86 common frames omitted
Caused by: org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.] [n/a]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:100)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:74)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcDatabaseMetaData(ImprovedExtractionContextImpl.java:70)
	at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.processTableResultSet(InformationExtractorJdbcDatabaseMetaDataImpl.java:65)
	at org.hibernate.tool.schema.extract.internal.AbstractInformationExtractorImpl.getTables(AbstractInformationExtractorImpl.java:570)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.getTablesInformation(DatabaseInformationImpl.java:122)
	at org.hibernate.tool.schema.internal.GroupedSchemaMigratorImpl.performTablesMigration(GroupedSchemaMigratorImpl.java:72)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:233)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	... 90 common frames omitted
Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:829)
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:449)
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:242)
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:198)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:139)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:368)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:205)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:483)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:571)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:101)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:111)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:126)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:483)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	... 111 common frames omitted
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:89)
	at com.mysql.cj.NativeSession.connect(NativeSession.java:120)
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:949)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819)
	... 124 common frames omitted
Caused by: java.net.ConnectException: Connection timed out: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:156)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63)
	... 127 common frames omitted
2025-07-13 21:16:51 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 1528 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 21:16:51 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 21:16:51 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 21:16:52 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 155 ms. Found 6 JPA repository interfaces.
2025-07-13 21:16:52 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 21:16:52 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 21:16:52 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 21:16:52 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 21:16:52 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1599 ms
2025-07-13 21:16:53 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 21:16:53 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 21:16:53 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 21:16:53 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 21:16:53 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 21:16:54 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2328ec73
2025-07-13 21:16:54 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 21:16:55 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 21:16:55 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 21:16:55 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 21:16:56 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 21:16:57 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 21:16:57 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 21:16:58 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 21:16:59 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 21:16:59 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 21:16:59 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-07-13 21:16:59 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileController:
	
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 21:17:00 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 21:17:00 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 21:17:00 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 21:17:00 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 21:17:00 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2b60acb3]
2025-07-13 21:17:00 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2b60acb3]
2025-07-13 21:17:00 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2b60acb3]]
2025-07-13 21:17:00 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 21:17:00 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 21:17:00 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 21:17:00 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 21:17:00 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 10.25 seconds (process running for 10.866)
2025-07-13 21:18:00 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-07-13 21:18:05 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 21:18:05 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 21:18:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 21:18:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 21:18:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 21:18:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@204e6dda
2025-07-13 21:18:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2c283221
2025-07-13 21:18:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 21:18:05 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-07-13 21:18:05 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752418085545", parameters={masked}
2025-07-13 21:18:05 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:18:05 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752418085545
2025-07-13 21:18:05 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:05 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/253/pjrmu1f3/websocket", parameters={}
2025-07-13 21:18:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:18:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/253/pjrmu1f3/websocket
2025-07-13 21:18:05 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:18:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=pjrmu1f3]
2025-07-13 21:18:05 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:18:05 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=pjrmu1f3
2025-07-13 21:18:05 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=pjrmu1f3
2025-07-13 21:18:05 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=pjrmu1f3
2025-07-13 21:18:05 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:18:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:18:07 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:18:07 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:09 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752418089380", parameters={masked}
2025-07-13 21:18:09 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:18:09 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752418089380
2025-07-13 21:18:09 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:09 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/480/njln52l4/websocket", parameters={}
2025-07-13 21:18:09 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:18:09 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/480/njln52l4/websocket
2025-07-13 21:18:09 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:18:09 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=njln52l4]
2025-07-13 21:18:09 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:18:09 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=njln52l4
2025-07-13 21:18:09 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=njln52l4
2025-07-13 21:18:09 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=njln52l4
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:18:10 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:10 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:18:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:18:10 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:18:10 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:18:11 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=njln52l4
2025-07-13 21:18:11 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=njln52l4
2025-07-13 21:18:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:18:11 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:11 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=njln52l4
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:18:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:18:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:18:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:16 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=pjrmu1f3
2025-07-13 21:18:16 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=pjrmu1f3
2025-07-13 21:18:16 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=pjrmu1f3
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:18:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:17 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:18:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:18:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:18:18 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:18:18 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:18:20 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:18:20 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:18:20 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:22:12 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@65823cdb (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:26:50 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@777349b5 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-07-13 21:30:09 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=njln52l4] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:30:09 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session njln52l4
2025-07-13 21:30:09 [http-nio-8080-exec-7] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:30:09 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=njln52l4
2025-07-13 21:30:09 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=njln52l4}], simpSessionId=njln52l4}]
2025-07-13 21:30:09 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=pjrmu1f3] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:30:09 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session pjrmu1f3
2025-07-13 21:30:09 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:30:09 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=pjrmu1f3
2025-07-13 21:30:09 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=pjrmu1f3}], simpSessionId=pjrmu1f3}]
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:10 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752418810287", parameters={masked}
2025-07-13 21:30:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:30:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752418810287
2025-07-13 21:30:10 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:10 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752418810445", parameters={masked}
2025-07-13 21:30:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:30:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752418810445
2025-07-13 21:30:10 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:10 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/226/1oaupjkr/websocket", parameters={}
2025-07-13 21:30:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:30:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/226/1oaupjkr/websocket
2025-07-13 21:30:10 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:30:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=1oaupjkr]
2025-07-13 21:30:10 [http-nio-8080-exec-7] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:30:10 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=1oaupjkr
2025-07-13 21:30:10 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/750/ufdxjfq0/websocket", parameters={}
2025-07-13 21:30:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:30:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/750/ufdxjfq0/websocket
2025-07-13 21:30:10 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:30:10 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=1oaupjkr
2025-07-13 21:30:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ufdxjfq0]
2025-07-13 21:30:10 [clientInboundChannel-46] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=1oaupjkr
2025-07-13 21:30:10 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:30:10 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ufdxjfq0
2025-07-13 21:30:10 [clientInboundChannel-52] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ufdxjfq0
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:30:10 [clientInboundChannel-55] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ufdxjfq0
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:30:10 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:30:11 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:30:11 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:11 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:30:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:30:11 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:30:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:30:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:30:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:30:12 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:15 [MessageBroker-13] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [pjrmu1f3, njln52l4]
2025-07-13 21:30:26 [clientInboundChannel-58] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=ufdxjfq0
2025-07-13 21:30:26 [clientInboundChannel-61] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=ufdxjfq0
2025-07-13 21:30:26 [clientInboundChannel-64] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=ufdxjfq0
2025-07-13 21:30:26 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:26 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:30:26 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:30:26 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:30:27 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:27 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:30:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:29 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:30:29 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:29 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:30:30 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:31 [clientInboundChannel-35] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=1oaupjkr
2025-07-13 21:30:31 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=1oaupjkr
2025-07-13 21:30:31 [clientInboundChannel-41] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=1oaupjkr
2025-07-13 21:30:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:30:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:30:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:30:31 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:30:32 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:32 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:30:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:30:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:30:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:30:33 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:30:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:30:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=57, co (truncated)...]
2025-07-13 21:30:34 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:12 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=1oaupjkr] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:31:12 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 1oaupjkr
2025-07-13 21:31:12 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:31:12 [clientInboundChannel-66] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=1oaupjkr
2025-07-13 21:31:12 [clientOutboundChannel-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=1oaupjkr}], simpSessionId=1oaupjkr}]
2025-07-13 21:31:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752418872693", parameters={masked}
2025-07-13 21:31:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:31:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752418872693
2025-07-13 21:31:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/647/c5njfw5n/websocket", parameters={}
2025-07-13 21:31:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:31:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/647/c5njfw5n/websocket
2025-07-13 21:31:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:31:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=c5njfw5n]
2025-07-13 21:31:12 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:31:12 [clientInboundChannel-69] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=c5njfw5n
2025-07-13 21:31:12 [clientInboundChannel-72] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=c5njfw5n
2025-07-13 21:31:12 [clientInboundChannel-75] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=c5njfw5n
2025-07-13 21:31:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:31:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:31:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:31:13 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:13 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:14 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:31:14 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:31:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:31:14 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:15 [clientInboundChannel-78] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=c5njfw5n
2025-07-13 21:31:15 [clientInboundChannel-81] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=c5njfw5n
2025-07-13 21:31:15 [clientInboundChannel-81] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=c5njfw5n
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:15 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:31:15 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:16 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ufdxjfq0] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:31:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ufdxjfq0
2025-07-13 21:31:19 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:31:19 [clientInboundChannel-60] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ufdxjfq0
2025-07-13 21:31:19 [clientOutboundChannel-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=ufdxjfq0}], simpSessionId=ufdxjfq0}]
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752418879464", parameters={masked}
2025-07-13 21:31:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:31:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752418879464
2025-07-13 21:31:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:19 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/575/dsexruef/websocket", parameters={}
2025-07-13 21:31:19 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:31:19 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/575/dsexruef/websocket
2025-07-13 21:31:19 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:31:19 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=dsexruef]
2025-07-13 21:31:19 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:31:19 [clientInboundChannel-63] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=dsexruef
2025-07-13 21:31:19 [clientInboundChannel-38] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=dsexruef
2025-07-13 21:31:19 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=dsexruef
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:19 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:20 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:31:20 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:31:20 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:20 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:31:20 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:31:20 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [1oaupjkr]
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:31:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:31:21 [clientInboundChannel-67] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=dsexruef
2025-07-13 21:31:21 [clientInboundChannel-67] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=dsexruef
2025-07-13 21:31:21 [clientInboundChannel-72] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=dsexruef
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:21 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:21 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:31:21 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:21 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:21 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:31:21 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:21 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:21 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:22 [clientInboundChannel-76] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=c5njfw5n
2025-07-13 21:31:22 [clientInboundChannel-57] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=c5njfw5n
2025-07-13 21:31:22 [clientInboundChannel-79] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=c5njfw5n
2025-07-13 21:31:22 [clientInboundChannel-79] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=c5njfw5n
2025-07-13 21:31:22 [clientInboundChannel-61] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=c5njfw5n
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:22 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:22 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:22 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:22 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:22 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:22 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:22 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:31:22 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:22 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:22 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:23 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:23 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:23 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[])]
2025-07-13 21:31:23 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:31:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:31:25 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 21:31:25 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 21:31:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:31:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=58, conversat (truncated)...]
2025-07-13 21:31:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:31:25 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [ufdxjfq0]
2025-07-13 21:38:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=c5njfw5n] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:38:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session c5njfw5n
2025-07-13 21:38:29 [http-nio-8080-exec-6] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:38:29 [clientInboundChannel-83] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=c5njfw5n
2025-07-13 21:38:29 [clientOutboundChannel-16] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=c5njfw5n}], simpSessionId=c5njfw5n}]
2025-07-13 21:38:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=dsexruef] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:38:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session dsexruef
2025-07-13 21:38:29 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:38:29 [clientInboundChannel-86] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=dsexruef
2025-07-13 21:38:29 [clientOutboundChannel-17] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=dsexruef}], simpSessionId=dsexruef}]
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419310261", parameters={masked}
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419310261
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:38:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/546/xylmdwt0/websocket", parameters={}
2025-07-13 21:38:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:38:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/546/xylmdwt0/websocket
2025-07-13 21:38:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:38:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=xylmdwt0]
2025-07-13 21:38:30 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:38:30 [clientInboundChannel-89] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=xylmdwt0
2025-07-13 21:38:30 [clientInboundChannel-92] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=xylmdwt0
2025-07-13 21:38:30 [clientInboundChannel-95] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=xylmdwt0
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:38:30 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:38:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419310547", parameters={masked}
2025-07-13 21:38:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:38:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419310547
2025-07-13 21:38:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/987/uceqjuay/websocket", parameters={}
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/987/uceqjuay/websocket
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:38:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=uceqjuay]
2025-07-13 21:38:30 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:38:30 [clientInboundChannel-98] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=uceqjuay
2025-07-13 21:38:30 [clientInboundChannel-101] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=uceqjuay
2025-07-13 21:38:30 [clientInboundChannel-104] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=uceqjuay
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:30 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:38:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:38:30 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:38:30 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:38:30 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:38:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:38:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:38:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:38:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:38:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:38:31 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:38:32 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:38:32 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:38:32 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:38:32 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:38:35 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [c5njfw5n, dsexruef]
2025-07-13 21:44:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=xylmdwt0] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:44:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session xylmdwt0
2025-07-13 21:44:14 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:44:14 [clientInboundChannel-107] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=xylmdwt0
2025-07-13 21:44:14 [clientOutboundChannel-20] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=xylmdwt0}], simpSessionId=xylmdwt0}]
2025-07-13 21:44:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=uceqjuay] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:44:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session uceqjuay
2025-07-13 21:44:14 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:44:14 [clientInboundChannel-110] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=uceqjuay
2025-07-13 21:44:14 [clientOutboundChannel-21] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=uceqjuay}], simpSessionId=uceqjuay}]
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419655076", parameters={masked}
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419655076
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:15 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/813/xjwgesq4/websocket", parameters={}
2025-07-13 21:44:15 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:44:15 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/813/xjwgesq4/websocket
2025-07-13 21:44:15 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:44:15 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=xjwgesq4]
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:44:15 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:44:15 [clientInboundChannel-113] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=xjwgesq4
2025-07-13 21:44:15 [clientInboundChannel-116] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=xjwgesq4
2025-07-13 21:44:15 [clientInboundChannel-119] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=xjwgesq4
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419655461", parameters={masked}
2025-07-13 21:44:15 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:44:15 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419655461
2025-07-13 21:44:15 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/486/mb5z04ec/websocket", parameters={}
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/486/mb5z04ec/websocket
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:44:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=mb5z04ec]
2025-07-13 21:44:15 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:44:15 [clientInboundChannel-122] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=mb5z04ec
2025-07-13 21:44:15 [clientInboundChannel-125] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=mb5z04ec
2025-07-13 21:44:15 [clientInboundChannel-128] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=mb5z04ec
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:44:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:44:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:44:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:44:16 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:44:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:44:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:44:17 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:20 [MessageBroker-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [xylmdwt0, uceqjuay]
2025-07-13 21:44:24 [clientInboundChannel-131] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=mb5z04ec
2025-07-13 21:44:24 [clientInboundChannel-134] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=mb5z04ec
2025-07-13 21:44:24 [clientInboundChannel-137] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=mb5z04ec
2025-07-13 21:44:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:24 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:44:24 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:44:24 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:44:25 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:44:25 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:25 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:44:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:25 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:26 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:26 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:44:26 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:44:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:27 [clientInboundChannel-108] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=xjwgesq4
2025-07-13 21:44:27 [clientInboundChannel-107] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=xjwgesq4
2025-07-13 21:44:27 [clientInboundChannel-114] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=xjwgesq4
2025-07-13 21:44:27 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:27 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:44:27 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:44:27 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:44:27 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:44:27 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:28 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:44:28 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:44:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:44:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:44:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=xjwgesq4] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:45:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session xjwgesq4
2025-07-13 21:45:05 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:45:05 [clientInboundChannel-116] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=xjwgesq4
2025-07-13 21:45:05 [clientOutboundChannel-24] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=xjwgesq4}], simpSessionId=xjwgesq4}]
2025-07-13 21:45:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=mb5z04ec] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:45:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session mb5z04ec
2025-07-13 21:45:05 [http-nio-8080-exec-5] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:45:05 [clientInboundChannel-120] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=mb5z04ec
2025-07-13 21:45:05 [clientOutboundChannel-25] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=mb5z04ec}], simpSessionId=mb5z04ec}]
2025-07-13 21:45:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:05 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419705825", parameters={masked}
2025-07-13 21:45:05 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:05 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419705825
2025-07-13 21:45:05 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:05 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/961/ds4ybewx/websocket", parameters={}
2025-07-13 21:45:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/961/ds4ybewx/websocket
2025-07-13 21:45:05 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:45:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ds4ybewx]
2025-07-13 21:45:05 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419705860", parameters={masked}
2025-07-13 21:45:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419705860
2025-07-13 21:45:05 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:05 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:45:05 [clientInboundChannel-122] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ds4ybewx
2025-07-13 21:45:05 [clientInboundChannel-126] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ds4ybewx
2025-07-13 21:45:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/691/qwyvw5b0/websocket", parameters={}
2025-07-13 21:45:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/691/qwyvw5b0/websocket
2025-07-13 21:45:05 [clientInboundChannel-129] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ds4ybewx
2025-07-13 21:45:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:45:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=qwyvw5b0]
2025-07-13 21:45:05 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:45:05 [clientInboundChannel-132] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=qwyvw5b0
2025-07-13 21:45:05 [clientInboundChannel-135] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=qwyvw5b0
2025-07-13 21:45:05 [clientInboundChannel-136] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=qwyvw5b0
2025-07-13 21:45:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:45:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:05 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:45:05 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:06 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:06 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:06 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:06 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:45:06 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:06 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:45:06 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:06 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:07 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:07 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:10 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [mb5z04ec, xjwgesq4]
2025-07-13 21:45:11 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ds4ybewx] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:45:11 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ds4ybewx
2025-07-13 21:45:11 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:45:11 [clientInboundChannel-111] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ds4ybewx
2025-07-13 21:45:11 [clientOutboundChannel-28] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=ds4ybewx}], simpSessionId=ds4ybewx}]
2025-07-13 21:45:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=qwyvw5b0] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:45:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session qwyvw5b0
2025-07-13 21:45:11 [http-nio-8080-exec-3] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:45:11 [clientInboundChannel-112] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=qwyvw5b0
2025-07-13 21:45:11 [clientOutboundChannel-29] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=qwyvw5b0}], simpSessionId=qwyvw5b0}]
2025-07-13 21:45:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419711518", parameters={masked}
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419711518
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/217/s2f3tdfe/websocket", parameters={}
2025-07-13 21:45:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/217/s2f3tdfe/websocket
2025-07-13 21:45:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:45:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=s2f3tdfe]
2025-07-13 21:45:11 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:45:11 [clientInboundChannel-115] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=s2f3tdfe
2025-07-13 21:45:11 [clientInboundChannel-118] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=s2f3tdfe
2025-07-13 21:45:11 [clientInboundChannel-121] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=s2f3tdfe
2025-07-13 21:45:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:11 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:45:11 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752419711680", parameters={masked}
2025-07-13 21:45:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752419711680
2025-07-13 21:45:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/973/5t1vd13l/websocket", parameters={}
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/973/5t1vd13l/websocket
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:45:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=5t1vd13l]
2025-07-13 21:45:11 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:45:11 [clientInboundChannel-124] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=5t1vd13l
2025-07-13 21:45:11 [clientInboundChannel-127] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=5t1vd13l
2025-07-13 21:45:11 [clientInboundChannel-130] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=5t1vd13l
2025-07-13 21:45:11 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:45:11 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:11 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:45:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:45:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:45:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:45:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:45:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:45:13 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:13 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:45:20 [MessageBroker-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [qwyvw5b0, ds4ybewx]
2025-07-13 21:48:00 [MessageBroker-7] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 14 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(14)-CONNECTED(14)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 249], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 31], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 493]
2025-07-13 21:51:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=s2f3tdfe] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:51:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session s2f3tdfe
2025-07-13 21:51:08 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:51:08 [clientInboundChannel-139] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=s2f3tdfe
2025-07-13 21:51:08 [clientOutboundChannel-32] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=s2f3tdfe}], simpSessionId=s2f3tdfe}]
2025-07-13 21:51:08 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=5t1vd13l] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:51:08 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 5t1vd13l
2025-07-13 21:51:08 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:51:08 [clientInboundChannel-142] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=5t1vd13l
2025-07-13 21:51:08 [clientOutboundChannel-33] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=5t1vd13l}], simpSessionId=5t1vd13l}]
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:09 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420069147", parameters={masked}
2025-07-13 21:51:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:51:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420069147
2025-07-13 21:51:09 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:09 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/352/gscsrocq/websocket", parameters={}
2025-07-13 21:51:09 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:51:09 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/352/gscsrocq/websocket
2025-07-13 21:51:09 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:51:09 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=gscsrocq]
2025-07-13 21:51:09 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:51:09 [clientInboundChannel-145] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=gscsrocq
2025-07-13 21:51:09 [clientInboundChannel-148] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=gscsrocq
2025-07-13 21:51:09 [clientInboundChannel-151] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=gscsrocq
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420069285", parameters={masked}
2025-07-13 21:51:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:51:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420069285
2025-07-13 21:51:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:51:09 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/097/gj0x0hou/websocket", parameters={}
2025-07-13 21:51:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:51:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/097/gj0x0hou/websocket
2025-07-13 21:51:09 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:51:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=gj0x0hou]
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:51:09 [clientInboundChannel-154] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=gj0x0hou
2025-07-13 21:51:09 [clientInboundChannel-157] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=gj0x0hou
2025-07-13 21:51:09 [clientInboundChannel-160] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=gj0x0hou
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:51:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:09 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:51:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:10 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:51:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:51:11 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:11 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:11 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:51:11 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:11 [clientInboundChannel-163] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=gj0x0hou
2025-07-13 21:51:11 [clientInboundChannel-166] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=gj0x0hou
2025-07-13 21:51:11 [clientInboundChannel-169] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=gj0x0hou
2025-07-13 21:51:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:51:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:51:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:51:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:51:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:51:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:51:12 [clientInboundChannel-139] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=gscsrocq
2025-07-13 21:51:12 [clientInboundChannel-142] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=gscsrocq
2025-07-13 21:51:12 [clientInboundChannel-142] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=gscsrocq
2025-07-13 21:51:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:51:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:51:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:51:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:13 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:51:13 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:51:14 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:51:14 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:51:15 [MessageBroker-15] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [5t1vd13l, s2f3tdfe]
2025-07-13 21:52:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=gj0x0hou] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:52:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session gj0x0hou
2025-07-13 21:52:02 [http-nio-8080-exec-6] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:52:02 [clientInboundChannel-148] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=gj0x0hou
2025-07-13 21:52:02 [clientOutboundChannel-36] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=gj0x0hou}], simpSessionId=gj0x0hou}]
2025-07-13 21:52:02 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=gscsrocq] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:52:02 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session gscsrocq
2025-07-13 21:52:02 [http-nio-8080-exec-7] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:52:02 [clientInboundChannel-151] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=gscsrocq
2025-07-13 21:52:02 [clientOutboundChannel-37] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=gscsrocq}], simpSessionId=gscsrocq}]
2025-07-13 21:52:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420122709", parameters={masked}
2025-07-13 21:52:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:52:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420122709
2025-07-13 21:52:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:02 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:52:02 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:52:02 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/233/q400we1d/websocket", parameters={}
2025-07-13 21:52:02 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:52:02 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/233/q400we1d/websocket
2025-07-13 21:52:02 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:52:02 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=q400we1d]
2025-07-13 21:52:02 [http-nio-8080-exec-1] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:52:02 [clientInboundChannel-154] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=q400we1d
2025-07-13 21:52:02 [clientInboundChannel-158] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=q400we1d
2025-07-13 21:52:02 [clientInboundChannel-161] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=q400we1d
2025-07-13 21:52:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:52:02 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:03 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420123377", parameters={masked}
2025-07-13 21:52:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:52:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420123377
2025-07-13 21:52:03 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/479/rhtynj4c/websocket", parameters={}
2025-07-13 21:52:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:52:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/479/rhtynj4c/websocket
2025-07-13 21:52:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:52:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=rhtynj4c]
2025-07-13 21:52:03 [http-nio-8080-exec-10] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:52:03 [clientInboundChannel-163] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=rhtynj4c
2025-07-13 21:52:03 [clientInboundChannel-166] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=rhtynj4c
2025-07-13 21:52:03 [clientInboundChannel-168] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=rhtynj4c
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:52:03 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:52:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:52:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:52:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:52:04 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:52:04 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:52:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:52:05 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:09 [clientInboundChannel-171] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=q400we1d
2025-07-13 21:52:09 [clientInboundChannel-174] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=q400we1d
2025-07-13 21:52:09 [clientInboundChannel-177] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=q400we1d
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:10 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:52:10 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:10 [MessageBroker-11] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [gj0x0hou, gscsrocq]
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:52:10 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:10 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:52:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:52:11 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:12 [clientInboundChannel-180] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=rhtynj4c
2025-07-13 21:52:12 [clientInboundChannel-183] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=rhtynj4c
2025-07-13 21:52:12 [clientInboundChannel-149] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=rhtynj4c
2025-07-13 21:52:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:52:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:13 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:52:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:52:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:52:14 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:14 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:14 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:14 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:52:14 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=58, co (truncated)...]
2025-07-13 21:52:14 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:52:19 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:52:19 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 21:52:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 21:52:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 21:52:19 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:52:19 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=59, conversat (truncated)...]
2025-07-13 21:52:20 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=q400we1d] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:57:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session q400we1d
2025-07-13 21:57:05 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:57:05 [clientInboundChannel-187] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=q400we1d
2025-07-13 21:57:05 [clientOutboundChannel-44] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=q400we1d}], simpSessionId=q400we1d}]
2025-07-13 21:57:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=rhtynj4c] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:57:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session rhtynj4c
2025-07-13 21:57:05 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:57:05 [clientInboundChannel-190] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=rhtynj4c
2025-07-13 21:57:05 [clientOutboundChannel-45] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=rhtynj4c}], simpSessionId=rhtynj4c}]
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:06 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420426211", parameters={masked}
2025-07-13 21:57:06 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:57:06 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420426211
2025-07-13 21:57:06 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:06 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/362/kb4ywzzk/websocket", parameters={}
2025-07-13 21:57:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:57:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/362/kb4ywzzk/websocket
2025-07-13 21:57:06 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:57:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=kb4ywzzk]
2025-07-13 21:57:06 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:57:06 [clientInboundChannel-193] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=kb4ywzzk
2025-07-13 21:57:06 [clientInboundChannel-196] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=kb4ywzzk
2025-07-13 21:57:06 [clientInboundChannel-199] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=kb4ywzzk
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420426585", parameters={masked}
2025-07-13 21:57:06 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:57:06 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420426585
2025-07-13 21:57:06 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:06 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/590/0er0qsan/websocket", parameters={}
2025-07-13 21:57:06 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:57:06 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/590/0er0qsan/websocket
2025-07-13 21:57:06 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:57:06 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=0er0qsan]
2025-07-13 21:57:06 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:57:06 [clientInboundChannel-202] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=0er0qsan
2025-07-13 21:57:06 [clientInboundChannel-205] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=0er0qsan
2025-07-13 21:57:06 [clientInboundChannel-208] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=0er0qsan
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:57:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:57:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:57:06 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:57:06 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:57:07 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:07 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:57:07 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:57:07 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:57:08 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:08 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:57:08 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:57:08 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:08 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:57:08 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:10 [MessageBroker-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [q400we1d, rhtynj4c]
2025-07-13 21:57:11 [clientInboundChannel-211] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=kb4ywzzk
2025-07-13 21:57:11 [clientInboundChannel-214] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=kb4ywzzk
2025-07-13 21:57:11 [clientInboundChannel-217] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=kb4ywzzk
2025-07-13 21:57:11 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:57:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:12 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:57:12 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:57:12 [clientInboundChannel-188] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=0er0qsan
2025-07-13 21:57:12 [clientInboundChannel-187] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=0er0qsan
2025-07-13 21:57:12 [clientInboundChannel-194] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=0er0qsan
2025-07-13 21:57:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:12 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:57:13 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:13 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:13 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:57:13 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:57:13 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:57:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:57:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:57:14 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:14 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:57:15 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:57:15 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:57:15 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=kb4ywzzk] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:58:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session kb4ywzzk
2025-07-13 21:58:45 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:58:45 [clientInboundChannel-219] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=kb4ywzzk
2025-07-13 21:58:45 [clientOutboundChannel-48] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=kb4ywzzk}], simpSessionId=kb4ywzzk}]
2025-07-13 21:58:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=0er0qsan] closed with CloseStatus[code=1000, reason=null]
2025-07-13 21:58:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 0er0qsan
2025-07-13 21:58:45 [http-nio-8080-exec-7] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 21:58:45 [clientInboundChannel-222] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=0er0qsan
2025-07-13 21:58:45 [clientOutboundChannel-49] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=0er0qsan}], simpSessionId=0er0qsan}]
2025-07-13 21:58:45 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:45 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420525622", parameters={masked}
2025-07-13 21:58:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:58:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420525622
2025-07-13 21:58:45 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/602/kbyreytm/websocket", parameters={}
2025-07-13 21:58:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:58:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/602/kbyreytm/websocket
2025-07-13 21:58:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:58:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=kbyreytm]
2025-07-13 21:58:45 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 21:58:45 [clientInboundChannel-225] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=kbyreytm
2025-07-13 21:58:45 [clientInboundChannel-228] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=kbyreytm
2025-07-13 21:58:45 [clientInboundChannel-231] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=kbyreytm
2025-07-13 21:58:45 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:58:45 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:58:45 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:58:45 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:58:45 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:58:46 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420526121", parameters={masked}
2025-07-13 21:58:46 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:58:46 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420526121
2025-07-13 21:58:46 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:46 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/670/01zivdz4/websocket", parameters={}
2025-07-13 21:58:46 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 21:58:46 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/670/01zivdz4/websocket
2025-07-13 21:58:46 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 21:58:46 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=01zivdz4]
2025-07-13 21:58:46 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 21:58:46 [clientInboundChannel-234] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=01zivdz4
2025-07-13 21:58:46 [clientInboundChannel-237] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=01zivdz4
2025-07-13 21:58:46 [clientInboundChannel-240] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=01zivdz4
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:58:46 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:58:47 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:47 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:58:47 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:47 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:47 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 21:58:47 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:47 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:58:47 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 21:58:47 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:50 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [kb4ywzzk, 0er0qsan]
2025-07-13 21:58:50 [clientInboundChannel-243] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=01zivdz4
2025-07-13 21:58:50 [clientInboundChannel-246] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=01zivdz4
2025-07-13 21:58:50 [clientInboundChannel-249] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=01zivdz4
2025-07-13 21:58:50 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:58:51 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:51 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:58:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:58:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:58:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:58:52 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:52 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:52 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:52 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:52 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:58:52 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:52 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 21:58:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 21:58:53 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 21:58:53 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=kbyreytm] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:00:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session kbyreytm
2025-07-13 22:00:30 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:00:30 [clientInboundChannel-251] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=kbyreytm
2025-07-13 22:00:30 [clientOutboundChannel-52] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=kbyreytm}], simpSessionId=kbyreytm}]
2025-07-13 22:00:30 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=01zivdz4] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:00:30 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 01zivdz4
2025-07-13 22:00:30 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:00:30 [clientInboundChannel-254] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=01zivdz4
2025-07-13 22:00:30 [clientOutboundChannel-53] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=01zivdz4}], simpSessionId=01zivdz4}]
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420631121", parameters={masked}
2025-07-13 22:00:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:00:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420631121
2025-07-13 22:00:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:31 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/458/tlu4qm04/websocket", parameters={}
2025-07-13 22:00:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:00:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/458/tlu4qm04/websocket
2025-07-13 22:00:31 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:00:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=tlu4qm04]
2025-07-13 22:00:31 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:00:31 [clientInboundChannel-257] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=tlu4qm04
2025-07-13 22:00:31 [clientInboundChannel-263] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=tlu4qm04
2025-07-13 22:00:31 [clientInboundChannel-260] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=tlu4qm04
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:31 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420631405", parameters={masked}
2025-07-13 22:00:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:00:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420631405
2025-07-13 22:00:31 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/330/4qgc030j/websocket", parameters={}
2025-07-13 22:00:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:00:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/330/4qgc030j/websocket
2025-07-13 22:00:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:00:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=4qgc030j]
2025-07-13 22:00:31 [http-nio-8080-exec-7] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:00:31 [clientInboundChannel-266] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=4qgc030j
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:00:31 [clientInboundChannel-269] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=4qgc030j
2025-07-13 22:00:31 [clientInboundChannel-272] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=4qgc030j
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:31 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:00:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:32 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:32 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:00:32 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:32 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:33 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:00:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:00:33 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:36 [clientInboundChannel-275] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=4qgc030j
2025-07-13 22:00:36 [clientInboundChannel-278] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=4qgc030j
2025-07-13 22:00:36 [clientInboundChannel-281] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=4qgc030j
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 22:00:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:37 [clientInboundChannel-252] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=tlu4qm04
2025-07-13 22:00:37 [clientInboundChannel-255] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=tlu4qm04
2025-07-13 22:00:37 [clientInboundChannel-258] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=tlu4qm04
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:37 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:00:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:00:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:00:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:37 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:00:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:38 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:38 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:38 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 22:00:38 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:00:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:38 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=59, co (truncated)...]
2025-07-13 22:00:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:00:40 [MessageBroker-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [kbyreytm, 01zivdz4]
2025-07-13 22:00:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:00:41 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 22:00:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 22:00:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"senderId":2,"content":"Hello","messageType":"TEXT","status":"SENT","sentAt":nu (truncated)..."]
2025-07-13 22:00:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:00:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=60, conversat (truncated)...]
2025-07-13 22:00:42 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"content":"","senderId":2,"messageType":"MEDIA","status":"SENT"}"]
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:01:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:01:01 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 22:01:01 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 22:01:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:01:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=61, conversat (truncated)...]
2025-07-13 22:01:01 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:03:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=tlu4qm04] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:03:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session tlu4qm04
2025-07-13 22:03:56 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:03:56 [clientInboundChannel-283] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=tlu4qm04
2025-07-13 22:03:56 [clientOutboundChannel-64] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=tlu4qm04}], simpSessionId=tlu4qm04}]
2025-07-13 22:03:56 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=4qgc030j] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:03:56 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 4qgc030j
2025-07-13 22:03:56 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:03:56 [clientInboundChannel-286] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=4qgc030j
2025-07-13 22:03:56 [clientOutboundChannel-65] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=4qgc030j}], simpSessionId=4qgc030j}]
2025-07-13 22:03:57 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:03:57 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420837762", parameters={masked}
2025-07-13 22:03:57 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:03:57 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420837762
2025-07-13 22:03:57 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:03:57 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/233/biinpk20/websocket", parameters={}
2025-07-13 22:03:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:03:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/233/biinpk20/websocket
2025-07-13 22:03:57 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:03:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=biinpk20]
2025-07-13 22:03:57 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:03:57 [clientInboundChannel-289] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=biinpk20
2025-07-13 22:03:57 [clientInboundChannel-292] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=biinpk20
2025-07-13 22:03:57 [clientInboundChannel-295] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=biinpk20
2025-07-13 22:03:57 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:03:57 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:03:57 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:03:58 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752420838284", parameters={masked}
2025-07-13 22:03:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:03:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752420838284
2025-07-13 22:03:58 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:03:58 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/170/mtoodsto/websocket", parameters={}
2025-07-13 22:03:58 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@46c09751
2025-07-13 22:03:58 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/170/mtoodsto/websocket
2025-07-13 22:03:58 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:03:58 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=mtoodsto]
2025-07-13 22:03:58 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:03:58 [clientInboundChannel-298] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=mtoodsto
2025-07-13 22:03:58 [clientInboundChannel-301] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=mtoodsto
2025-07-13 22:03:58 [clientInboundChannel-304] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=mtoodsto
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:03:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:03:58 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:03:58 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:03:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:03:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:03:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:03:59 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:03:59 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:03:59 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:03:59 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:04:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:04:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:04:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:04:05 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [tlu4qm04, 4qgc030j]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:06:20 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session biinpk20 with CloseStatus[code=1001, reason=null]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=biinpk20]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=biinpk20] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session biinpk20
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session mtoodsto with CloseStatus[code=1001, reason=null]
2025-07-13 22:06:20 [clientInboundChannel-307] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=biinpk20
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=mtoodsto]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=mtoodsto] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session mtoodsto
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2b60acb3]]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2b60acb3]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2b60acb3]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:06:20 [RMI TCP Connection(53)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:06:22 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 31020 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:06:22 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:06:23 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:06:23 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 103 ms. Found 6 JPA repository interfaces.
2025-07-13 22:06:24 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:06:24 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:06:24 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:06:24 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:06:24 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1445 ms
2025-07-13 22:06:24 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:06:24 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:06:24 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:06:24 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:06:24 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:06:25 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@31f5b923
2025-07-13 22:06:25 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:06:25 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:06:25 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:06:25 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:06:27 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:06:27 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:06:27 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:06:28 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:06:28 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 17 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:06:29 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:06:29 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:06:29 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:06:29 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:06:29 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:06:29 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:06:29 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]]
2025-07-13 22:06:29 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:06:29 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:06:29 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:06:29 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:06:29 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 7.301 seconds (process running for 7.881)
2025-07-13 22:06:40 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:06:40 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@243fe859
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@7ad9ed91
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:06:40 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421000144", parameters={masked}
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421000144
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:40 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/833/fswkfrkg/websocket", parameters={}
2025-07-13 22:06:40 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:06:40 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/833/fswkfrkg/websocket
2025-07-13 22:06:40 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:06:40 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=fswkfrkg]
2025-07-13 22:06:40 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:06:40 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=fswkfrkg
2025-07-13 22:06:40 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=fswkfrkg
2025-07-13 22:06:40 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=fswkfrkg
2025-07-13 22:06:40 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421000426", parameters={masked}
2025-07-13 22:06:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:06:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421000426
2025-07-13 22:06:40 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/389/a135u4mk/websocket", parameters={}
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/389/a135u4mk/websocket
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:06:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=a135u4mk]
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:40 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:40 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:06:40 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=a135u4mk
2025-07-13 22:06:40 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=a135u4mk
2025-07-13 22:06:40 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=a135u4mk
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:06:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:06:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:06:40 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:06:40 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:06:40 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:40 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:06:41 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:41 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:41 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:41 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:06:41 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:06:41 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:06:41 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:06:41 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:41 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:06:42 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:42 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:43 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=a135u4mk
2025-07-13 22:06:43 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=a135u4mk
2025-07-13 22:06:43 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=a135u4mk
2025-07-13 22:06:43 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:06:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:06:43 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=61, co (truncated)...]
2025-07-13 22:06:44 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:44 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:44 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:06:44 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:06:44 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:44 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=fswkfrkg
2025-07-13 22:06:44 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=fswkfrkg
2025-07-13 22:06:44 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=fswkfrkg
2025-07-13 22:06:44 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:44 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=61, co (truncated)...]
2025-07-13 22:06:45 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=61, co (truncated)...]
2025-07-13 22:06:45 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:06:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:46 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:06:46 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:46 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=61, co (truncated)...]
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=61, co (truncated)...]
2025-07-13 22:06:46 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:46 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:46 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:06:46 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:06:46 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=61, co (truncated)...]
2025-07-13 22:06:47 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:06:53 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:06:53 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 22:06:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 22:06:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"content":"","senderId":2,"messageType":"MEDIA","status":"SENT"}"]
2025-07-13 22:06:53 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"eventType":"NEW_MESSAG...(truncated)
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=62, conversat (truncated)...]
2025-07-13 22:06:54 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:07:29 [MessageBroker-14] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 36], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 12]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:08:48 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session fswkfrkg with CloseStatus[code=1001, reason=null]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=fswkfrkg]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=fswkfrkg] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session fswkfrkg
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:08:48 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=fswkfrkg
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session a135u4mk with CloseStatus[code=1001, reason=null]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=a135u4mk]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=a135u4mk] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session a135u4mk
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:08:48 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=a135u4mk
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:08:48 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:08:50 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 11944 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:08:50 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:08:51 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:08:51 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 60 ms. Found 6 JPA repository interfaces.
2025-07-13 22:08:52 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:08:52 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:08:52 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:08:52 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:08:52 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1364 ms
2025-07-13 22:08:52 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:08:52 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:08:52 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:08:52 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:08:52 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:08:53 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@839755f
2025-07-13 22:08:53 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:08:53 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:08:53 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:08:53 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:08:55 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:08:55 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:08:55 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:08:56 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:08:56 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 17 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:08:57 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:08:57 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:08:57 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:08:57 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:08:57 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@663e2cfd]
2025-07-13 22:08:57 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@663e2cfd]
2025-07-13 22:08:57 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@663e2cfd]]
2025-07-13 22:08:57 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:08:57 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:08:57 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:08:57 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:08:57 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 7.18 seconds (process running for 7.693)
2025-07-13 22:09:33 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:09:33 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@66896ed0
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@204e6dda
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:09:33 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421173439", parameters={masked}
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@4310d985
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421173439
2025-07-13 22:09:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:33 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/241/zt0e2ocr/websocket", parameters={}
2025-07-13 22:09:33 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@4310d985
2025-07-13 22:09:33 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/241/zt0e2ocr/websocket
2025-07-13 22:09:33 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:09:33 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zt0e2ocr]
2025-07-13 22:09:33 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:09:33 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=zt0e2ocr
2025-07-13 22:09:33 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=zt0e2ocr
2025-07-13 22:09:33 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=zt0e2ocr
2025-07-13 22:09:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:34 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421174008", parameters={masked}
2025-07-13 22:09:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@4310d985
2025-07-13 22:09:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421174008
2025-07-13 22:09:34 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:34 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/000/lxdi1eda/websocket", parameters={}
2025-07-13 22:09:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@4310d985
2025-07-13 22:09:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/000/lxdi1eda/websocket
2025-07-13 22:09:34 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:09:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lxdi1eda]
2025-07-13 22:09:34 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:09:34 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=lxdi1eda
2025-07-13 22:09:34 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=lxdi1eda
2025-07-13 22:09:34 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=lxdi1eda
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:34 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:09:34 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:09:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:35 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:35 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:09:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:09:35 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:35 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:35 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:09:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:09:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:09:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:09:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:36 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:37 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=zt0e2ocr
2025-07-13 22:09:37 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=zt0e2ocr
2025-07-13 22:09:37 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=zt0e2ocr
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:37 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:38 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=62, co (truncated)...]
2025-07-13 22:09:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:39 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:39 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:39 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=62, co (truncated)...]
2025-07-13 22:09:39 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=62, co (truncated)...]
2025-07-13 22:09:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:40 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=lxdi1eda
2025-07-13 22:09:40 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=lxdi1eda
2025-07-13 22:09:40 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=lxdi1eda
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:41 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:41 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=62, co (truncated)...]
2025-07-13 22:09:41 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=62, co (truncated)...]
2025-07-13 22:09:42 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:42 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:43 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:43 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:43 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=62, co (truncated)...]
2025-07-13 22:09:43 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:49 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:09:49 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/messages", parameters={multipart}
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#sendMessage(String, List)
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestPartMethodArgumentResolver - Read "application/json" to ["{"conversationId":13,"content":"","senderId":2,"messageType":"MEDIA","status":"SENT"}"]
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        messages
        (content, conversation_id, message_type, sender_id, sent_at) 
    values
        (?, ?, ?, ?, ?)
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        attachments
        (file_size_bytes, file_type, file_url, message_id) 
    values
        (?, ?, ?, ?)
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/13/messages session=null payload={"success":true,"message":"New message received","data":{"message":{"messageId":...(truncated)
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 2 sessions.
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Message sent successfully, data=MessageDto(messageId=63, conversat (truncated)...]
2025-07-13 22:09:50 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:09:57 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 36], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 15, active threads = 1, queued tasks = 3, completed tasks = 5]
2025-07-13 22:12:00 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:12:00 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:12:01 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session zt0e2ocr with CloseStatus[code=1001, reason=null]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=zt0e2ocr]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zt0e2ocr] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session zt0e2ocr
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session lxdi1eda with CloseStatus[code=1001, reason=null]
2025-07-13 22:12:01 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=zt0e2ocr
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=lxdi1eda]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lxdi1eda] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session lxdi1eda
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:12:01 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=lxdi1eda
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@663e2cfd]]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@663e2cfd]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@663e2cfd]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:12:01 [RMI TCP Connection(5)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:12:06 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 39080 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:12:06 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:12:07 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:12:07 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 94 ms. Found 6 JPA repository interfaces.
2025-07-13 22:12:07 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:12:07 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:12:07 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:12:07 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:12:07 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1579 ms
2025-07-13 22:12:08 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:12:08 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:12:08 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:12:08 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:12:08 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:12:09 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5c997de8
2025-07-13 22:12:09 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:12:09 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:12:09 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:12:09 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:12:11 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:12:11 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:12:11 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:12:12 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:12:13 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 18 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:12:13 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:12:13 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:12:13 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:12:13 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:12:13 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@31b9a628]
2025-07-13 22:12:13 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@31b9a628]
2025-07-13 22:12:13 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@31b9a628]]
2025-07-13 22:12:13 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:12:13 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:12:13 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:12:13 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:12:13 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 8.054 seconds (process running for 8.615)
2025-07-13 22:12:13 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:12:13 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:12:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:12:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:12:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:12:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4c9a3ae
2025-07-13 22:12:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@451cef5
2025-07-13 22:12:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:12:13 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-07-13 22:12:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421331470", parameters={masked}
2025-07-13 22:12:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421331470
2025-07-13 22:12:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:13 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/300/p2tu0r1k/websocket", parameters={}
2025-07-13 22:12:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/300/p2tu0r1k/websocket
2025-07-13 22:12:13 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:12:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=p2tu0r1k]
2025-07-13 22:12:14 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:12:14 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=p2tu0r1k
2025-07-13 22:12:14 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=p2tu0r1k
2025-07-13 22:12:14 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=p2tu0r1k
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:15 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:15 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:15 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421335917", parameters={masked}
2025-07-13 22:12:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421335917
2025-07-13 22:12:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:15 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/411/4m1p3g1c/websocket", parameters={}
2025-07-13 22:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/411/4m1p3g1c/websocket
2025-07-13 22:12:15 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=4m1p3g1c]
2025-07-13 22:12:15 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:12:15 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=4m1p3g1c
2025-07-13 22:12:15 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=4m1p3g1c
2025-07-13 22:12:15 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=4m1p3g1c
2025-07-13 22:12:15 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:16 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:16 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:17 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:18 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=4m1p3g1c
2025-07-13 22:12:18 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=4m1p3g1c
2025-07-13 22:12:18 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=4m1p3g1c
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:19 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:20 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:21 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=4m1p3g1c] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:12:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 4m1p3g1c
2025-07-13 22:12:32 [http-nio-8080-exec-2] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:12:32 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=4m1p3g1c
2025-07-13 22:12:32 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=4m1p3g1c}], simpSessionId=4m1p3g1c}]
2025-07-13 22:12:32 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:32 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421352829", parameters={masked}
2025-07-13 22:12:32 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:32 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421352829
2025-07-13 22:12:32 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:32 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/053/whu4idiq/websocket", parameters={}
2025-07-13 22:12:32 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:32 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/053/whu4idiq/websocket
2025-07-13 22:12:32 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:12:32 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=whu4idiq]
2025-07-13 22:12:32 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:12:32 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=whu4idiq
2025-07-13 22:12:32 [clientInboundChannel-1] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=whu4idiq
2025-07-13 22:12:32 [clientInboundChannel-1] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=whu4idiq
2025-07-13 22:12:32 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:12:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:33 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:33 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:12:33 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:34 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=p2tu0r1k] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:12:34 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session p2tu0r1k
2025-07-13 22:12:34 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:12:34 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=p2tu0r1k
2025-07-13 22:12:34 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=p2tu0r1k}], simpSessionId=p2tu0r1k}]
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:34 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:34 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421354840", parameters={masked}
2025-07-13 22:12:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421354840
2025-07-13 22:12:34 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:34 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/199/d1ovlyya/websocket", parameters={}
2025-07-13 22:12:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:12:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/199/d1ovlyya/websocket
2025-07-13 22:12:34 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:12:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=d1ovlyya]
2025-07-13 22:12:34 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:12:34 [clientInboundChannel-12] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=d1ovlyya
2025-07-13 22:12:34 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=d1ovlyya
2025-07-13 22:12:34 [clientInboundChannel-18] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=d1ovlyya
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:35 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:12:36 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:38 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [4m1p3g1c]
2025-07-13 22:12:43 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=whu4idiq
2025-07-13 22:12:43 [clientInboundChannel-24] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=whu4idiq
2025-07-13 22:12:43 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=whu4idiq
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:43 [MessageBroker-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [p2tu0r1k]
2025-07-13 22:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:44 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:44 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:44 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:45 [clientInboundChannel-28] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=d1ovlyya
2025-07-13 22:12:45 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=d1ovlyya
2025-07-13 22:12:45 [clientInboundChannel-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=d1ovlyya
2025-07-13 22:12:45 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:12:45 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:45 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:45 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:46 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:46 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:46 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:12:46 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:46 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:47 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:12:47 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:12:47 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:12:47 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:12:48 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:13:13 [MessageBroker-6] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 4 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(4)-CONNECTED(4)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 69], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 14]
2025-07-13 22:14:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=whu4idiq] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:14:16 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session whu4idiq
2025-07-13 22:14:16 [http-nio-8080-exec-2] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:14:16 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=whu4idiq
2025-07-13 22:14:16 [clientOutboundChannel-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=whu4idiq}], simpSessionId=whu4idiq}]
2025-07-13 22:14:16 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=d1ovlyya] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:14:16 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session d1ovlyya
2025-07-13 22:14:16 [http-nio-8080-exec-5] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:14:16 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=d1ovlyya
2025-07-13 22:14:16 [clientOutboundChannel-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=d1ovlyya}], simpSessionId=d1ovlyya}]
2025-07-13 22:14:16 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421456812", parameters={masked}
2025-07-13 22:14:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:14:16 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421456812
2025-07-13 22:14:16 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:14:16 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:14:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/115/ytx0u4zb/websocket", parameters={}
2025-07-13 22:14:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:14:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/115/ytx0u4zb/websocket
2025-07-13 22:14:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:14:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ytx0u4zb]
2025-07-13 22:14:16 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:14:16 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ytx0u4zb
2025-07-13 22:14:16 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ytx0u4zb
2025-07-13 22:14:16 [clientInboundChannel-46] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ytx0u4zb
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421457194", parameters={masked}
2025-07-13 22:14:17 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:14:17 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421457194
2025-07-13 22:14:17 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/999/scmibcbg/websocket", parameters={}
2025-07-13 22:14:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2d2325d0
2025-07-13 22:14:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/999/scmibcbg/websocket
2025-07-13 22:14:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:14:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=scmibcbg]
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:14:17 [http-nio-8080-exec-9] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:14:17 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=scmibcbg
2025-07-13 22:14:17 [clientInboundChannel-52] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=scmibcbg
2025-07-13 22:14:17 [clientInboundChannel-55] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=scmibcbg
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:14:17 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:14:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:14:17 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:14:17 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:14:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:14:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:14:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:14:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:14:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:14:18 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:14:23 [MessageBroker-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [whu4idiq, d1ovlyya]
2025-07-13 22:15:00 [clientInboundChannel-58] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=scmibcbg
2025-07-13 22:15:00 [clientInboundChannel-61] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=scmibcbg
2025-07-13 22:15:00 [clientInboundChannel-64] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=scmibcbg
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:15:00 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:15:01 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:15:01 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:15:01 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:15:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:15:01 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:15:01 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:15:01 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:15:02 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:15:02 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:15:02 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:15:02 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:15:02 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:15:03 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:16:13 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session scmibcbg with CloseStatus[code=1001, reason=null]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=scmibcbg]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=scmibcbg] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session scmibcbg
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session ytx0u4zb with CloseStatus[code=1001, reason=null]
2025-07-13 22:16:13 [clientInboundChannel-66] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=scmibcbg
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=ytx0u4zb]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ytx0u4zb] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ytx0u4zb
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:16:13 [clientInboundChannel-69] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ytx0u4zb
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@31b9a628]]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@31b9a628]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@31b9a628]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:16:13 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:16:15 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 8500 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:16:15 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:16:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:16:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 106 ms. Found 6 JPA repository interfaces.
2025-07-13 22:16:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:16:17 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:16:17 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:16:17 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:16:17 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1564 ms
2025-07-13 22:16:17 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:16:17 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:16:17 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:16:17 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:16:17 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:16:18 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7bda01da
2025-07-13 22:16:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:16:18 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:16:18 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:16:18 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:16:20 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:16:20 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:16:21 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:16:21 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:16:22 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 18 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:16:22 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:16:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:16:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:16:23 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:16:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6e2a6063]
2025-07-13 22:16:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6e2a6063]
2025-07-13 22:16:23 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6e2a6063]]
2025-07-13 22:16:23 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:16:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:16:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:16:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:16:23 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 8.107 seconds (process running for 8.629)
2025-07-13 22:16:28 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:16:28 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:16:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:16:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:16:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:16:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@2c27d6e5
2025-07-13 22:16:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@4415cc21
2025-07-13 22:16:28 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:16:28 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-07-13 22:16:28 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421588794", parameters={masked}
2025-07-13 22:16:28 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3a5b73cb
2025-07-13 22:16:28 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421588794
2025-07-13 22:16:28 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:16:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/992/img35fsa/websocket", parameters={}
2025-07-13 22:16:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3a5b73cb
2025-07-13 22:16:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/992/img35fsa/websocket
2025-07-13 22:16:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:16:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=img35fsa]
2025-07-13 22:16:28 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:16:28 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=img35fsa
2025-07-13 22:16:28 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=img35fsa
2025-07-13 22:16:28 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=img35fsa
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:16:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:16:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:16:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:16:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:16:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:16:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:16:39 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=img35fsa
2025-07-13 22:16:39 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=img35fsa
2025-07-13 22:16:39 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=img35fsa
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:40 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:41 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:41 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:41 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:41 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:16:41 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:16:41 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:16:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:16:42 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:17:23 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 18, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 1, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 2, completed tasks = 13]
2025-07-13 22:19:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:19:13 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:19:14 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session img35fsa with CloseStatus[code=1001, reason=null]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=img35fsa]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=img35fsa] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session img35fsa
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:19:14 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=img35fsa
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6e2a6063]]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6e2a6063]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6e2a6063]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:19:14 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:19:16 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 35768 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:19:16 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:19:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:19:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 73 ms. Found 6 JPA repository interfaces.
2025-07-13 22:19:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:19:17 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:19:17 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:19:17 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:19:17 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1547 ms
2025-07-13 22:19:18 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:19:18 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:19:18 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:19:18 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:19:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:19:19 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@75e4fe3c
2025-07-13 22:19:19 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:19:19 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:19:19 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:19:19 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:19:20 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:19:21 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:19:21 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:19:22 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:19:22 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 18 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:19:23 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:19:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:19:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:19:23 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:19:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@c3745ae]
2025-07-13 22:19:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@c3745ae]
2025-07-13 22:19:23 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@c3745ae]]
2025-07-13 22:19:23 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:19:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:19:23 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:19:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:19:23 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 7.79 seconds (process running for 8.356)
2025-07-13 22:19:33 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:19:33 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:19:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:19:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:19:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:19:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@784bb800
2025-07-13 22:19:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@4377d616
2025-07-13 22:19:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:19:33 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-13 22:19:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421773360", parameters={masked}
2025-07-13 22:19:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@172b39c3
2025-07-13 22:19:33 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421773360
2025-07-13 22:19:33 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/680/ifiyzb4i/websocket", parameters={}
2025-07-13 22:19:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@172b39c3
2025-07-13 22:19:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/680/ifiyzb4i/websocket
2025-07-13 22:19:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:19:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ifiyzb4i]
2025-07-13 22:19:33 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:19:33 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ifiyzb4i
2025-07-13 22:19:33 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ifiyzb4i
2025-07-13 22:19:33 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ifiyzb4i
2025-07-13 22:19:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:33 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:19:33 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:19:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:19:34 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:34 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:34 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:19:34 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:19:35 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=ifiyzb4i
2025-07-13 22:19:35 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=ifiyzb4i
2025-07-13 22:19:35 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=ifiyzb4i
2025-07-13 22:19:35 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:19:35 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:35 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:19:35 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:19:35 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:19:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:19:37 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=ifiyzb4i
2025-07-13 22:19:37 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=ifiyzb4i
2025-07-13 22:19:37 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=ifiyzb4i
2025-07-13 22:19:37 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=ifiyzb4i
2025-07-13 22:19:37 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=ifiyzb4i
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:37 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:38 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:38 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:19:38 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:39 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:39 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:39 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:19:39 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:39 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:40 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:19:40 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:19:41 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:19:41 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:19:41 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:20:23 [MessageBroker-5] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 33], outboundChannel[pool size = 1, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 2, completed tasks = 13]
2025-07-13 22:21:00 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:21:00 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:21:01 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session ifiyzb4i with CloseStatus[code=1001, reason=null]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=ifiyzb4i]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ifiyzb4i] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ifiyzb4i
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:21:01 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ifiyzb4i
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@c3745ae]]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@c3745ae]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@c3745ae]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:21:01 [RMI TCP Connection(6)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:21:03 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 33756 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:21:03 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:21:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:21:04 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 6 JPA repository interfaces.
2025-07-13 22:21:04 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:21:04 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:21:04 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:21:04 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:21:04 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1447 ms
2025-07-13 22:21:04 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:21:04 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:21:04 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:21:05 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:21:05 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:21:06 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@31f5b923
2025-07-13 22:21:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:21:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:21:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:21:06 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:21:07 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:21:08 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:21:08 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:21:08 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:21:09 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:21:09 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:21:09 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 18 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:21:09 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:21:10 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:21:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:21:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:21:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:21:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:21:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:21:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]]
2025-07-13 22:21:10 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:21:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:21:10 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:21:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:21:10 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 7.835 seconds (process running for 8.382)
2025-07-13 22:21:29 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:21:29 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@243fe859
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@7ad9ed91
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:21:29 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421889643", parameters={masked}
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421889643
2025-07-13 22:21:29 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:21:29 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/105/jdt1zbqe/websocket", parameters={}
2025-07-13 22:21:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:21:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/105/jdt1zbqe/websocket
2025-07-13 22:21:29 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:21:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=jdt1zbqe]
2025-07-13 22:21:29 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:21:29 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=jdt1zbqe
2025-07-13 22:21:29 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=jdt1zbqe
2025-07-13 22:21:29 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=jdt1zbqe
2025-07-13 22:21:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:21:31 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:21:31 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:21:31 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:21:31 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=jdt1zbqe
2025-07-13 22:21:31 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=jdt1zbqe
2025-07-13 22:21:31 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=jdt1zbqe
2025-07-13 22:21:31 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:21:31 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:21:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:21:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:21:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:21:32 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:32 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:21:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:21:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:21:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:21:34 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:34 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:21:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:21:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:21:35 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:22:10 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 18, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 1, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 2, completed tasks = 10]
2025-07-13 22:22:59 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=jdt1zbqe] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:22:59 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session jdt1zbqe
2025-07-13 22:22:59 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:22:59 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=jdt1zbqe
2025-07-13 22:22:59 [clientOutboundChannel-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=jdt1zbqe}], simpSessionId=jdt1zbqe}]
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:23:00 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752421980032", parameters={masked}
2025-07-13 22:23:00 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:23:00 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752421980032
2025-07-13 22:23:00 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:23:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/418/23zbawux/websocket", parameters={}
2025-07-13 22:23:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:23:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/418/23zbawux/websocket
2025-07-13 22:23:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:23:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=23zbawux]
2025-07-13 22:23:00 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:23:00 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=23zbawux
2025-07-13 22:23:00 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=23zbawux
2025-07-13 22:23:00 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=23zbawux
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:23:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:23:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:23:01 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:23:01 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:23:04 [MessageBroker-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [jdt1zbqe]
2025-07-13 22:23:14 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=23zbawux
2025-07-13 22:23:14 [clientInboundChannel-35] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=23zbawux
2025-07-13 22:23:14 [clientInboundChannel-38] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=23zbawux
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:23:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:23:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:23:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:23:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:23:15 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:23:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:23:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:23:16 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:23:16 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:23:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:27:37 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=23zbawux] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:27:37 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 23zbawux
2025-07-13 22:27:37 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:27:37 [clientInboundChannel-41] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=23zbawux
2025-07-13 22:27:37 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=23zbawux}], simpSessionId=23zbawux}]
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:27:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422258371", parameters={masked}
2025-07-13 22:27:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:27:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422258371
2025-07-13 22:27:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:27:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/063/lv5f02yi/websocket", parameters={}
2025-07-13 22:27:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:27:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/063/lv5f02yi/websocket
2025-07-13 22:27:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:27:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lv5f02yi]
2025-07-13 22:27:38 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:27:38 [clientInboundChannel-44] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=lv5f02yi
2025-07-13 22:27:38 [clientInboundChannel-47] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=lv5f02yi
2025-07-13 22:27:38 [clientInboundChannel-50] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=lv5f02yi
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:27:38 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:27:39 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:27:39 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:27:39 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:27:39 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:27:39 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:27:40 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:27:40 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:27:40 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:27:44 [MessageBroker-11] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [23zbawux]
2025-07-13 22:28:53 [clientInboundChannel-53] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=lv5f02yi
2025-07-13 22:28:53 [clientInboundChannel-56] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=lv5f02yi
2025-07-13 22:28:53 [clientInboundChannel-59] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=lv5f02yi
2025-07-13 22:28:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:28:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:28:55 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:56 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:28:56 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:28:56 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:56 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:57 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:28:57 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:28:57 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:28:57 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:01 [clientInboundChannel-62] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=lv5f02yi
2025-07-13 22:29:01 [clientInboundChannel-65] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=lv5f02yi
2025-07-13 22:29:01 [clientInboundChannel-68] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=lv5f02yi
2025-07-13 22:29:01 [clientInboundChannel-71] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=lv5f02yi
2025-07-13 22:29:01 [clientInboundChannel-74] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=lv5f02yi
2025-07-13 22:29:01 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:04 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:04 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:04 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:05 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:05 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:05 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:05 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:12 [clientInboundChannel-77] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-5 session=lv5f02yi
2025-07-13 22:29:12 [clientInboundChannel-80] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-6 session=lv5f02yi
2025-07-13 22:29:12 [clientInboundChannel-83] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-8 session=lv5f02yi
2025-07-13 22:29:12 [clientInboundChannel-54] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-9 session=lv5f02yi
2025-07-13 22:29:12 [clientInboundChannel-56] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-10 session=lv5f02yi
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:12 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:13 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:13 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:13 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:19 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lv5f02yi] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:29:19 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session lv5f02yi
2025-07-13 22:29:19 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:29:19 [clientInboundChannel-59] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=lv5f02yi
2025-07-13 22:29:19 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=lv5f02yi}], simpSessionId=lv5f02yi}]
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:20 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422360078", parameters={masked}
2025-07-13 22:29:20 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:29:20 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422360078
2025-07-13 22:29:20 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:20 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/077/dv5tqq4e/websocket", parameters={}
2025-07-13 22:29:20 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:29:20 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/077/dv5tqq4e/websocket
2025-07-13 22:29:20 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:29:20 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=dv5tqq4e]
2025-07-13 22:29:20 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:29:20 [clientInboundChannel-63] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=dv5tqq4e
2025-07-13 22:29:20 [clientInboundChannel-65] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=dv5tqq4e
2025-07-13 22:29:20 [clientInboundChannel-68] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=dv5tqq4e
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:29:21 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:21 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:29:21 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:29:21 [clientInboundChannel-72] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=dv5tqq4e
2025-07-13 22:29:21 [clientInboundChannel-75] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=dv5tqq4e
2025-07-13 22:29:21 [clientInboundChannel-78] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=dv5tqq4e
2025-07-13 22:29:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:29:21 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:23 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:23 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:23 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:24 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:24 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:24 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:24 [MessageBroker-16] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [lv5f02yi]
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:24 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:25 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:25 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422370147", parameters={masked}
2025-07-13 22:29:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:29:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422370147
2025-07-13 22:29:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:30 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/919/ikt0zcvv/websocket", parameters={}
2025-07-13 22:29:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:29:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/919/ikt0zcvv/websocket
2025-07-13 22:29:30 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:29:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ikt0zcvv]
2025-07-13 22:29:30 [http-nio-8080-exec-1] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:29:30 [clientInboundChannel-81] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=ikt0zcvv
2025-07-13 22:29:30 [clientInboundChannel-82] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=ikt0zcvv
2025-07-13 22:29:30 [clientInboundChannel-53] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=ikt0zcvv
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:29:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:29:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:31 [clientInboundChannel-58] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=ikt0zcvv
2025-07-13 22:29:31 [clientInboundChannel-56] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=ikt0zcvv
2025-07-13 22:29:31 [clientInboundChannel-64] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=ikt0zcvv
2025-07-13 22:29:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:29:31 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:29:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:32 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:32 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:29:32 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:32 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:32 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:34 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:34 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:29:35 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:29:35 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:29:35 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=dv5tqq4e] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:30:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session dv5tqq4e
2025-07-13 22:30:14 [http-nio-8080-exec-9] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:30:14 [clientInboundChannel-85] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=dv5tqq4e
2025-07-13 22:30:14 [clientOutboundChannel-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=dv5tqq4e}], simpSessionId=dv5tqq4e}]
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422418336", parameters={masked}
2025-07-13 22:30:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:30:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422418336
2025-07-13 22:30:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:18 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/601/q3lqbzll/websocket", parameters={}
2025-07-13 22:30:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:30:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/601/q3lqbzll/websocket
2025-07-13 22:30:18 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:30:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=q3lqbzll]
2025-07-13 22:30:18 [http-nio-8080-exec-5] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:30:18 [clientInboundChannel-88] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=q3lqbzll
2025-07-13 22:30:18 [clientInboundChannel-91] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=q3lqbzll
2025-07-13 22:30:18 [clientInboundChannel-91] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=q3lqbzll
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:30:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:19 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:30:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:30:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:30:19 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:20 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:30:20 [clientInboundChannel-74] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=q3lqbzll
2025-07-13 22:30:20 [clientInboundChannel-93] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=q3lqbzll
2025-07-13 22:30:20 [clientInboundChannel-78] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=q3lqbzll
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:20 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:20 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:30:20 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:20 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:21 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:21 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:21 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:30:21 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:21 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:22 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:22 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:22 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:30:22 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:30:23 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:24 [MessageBroker-12] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [dv5tqq4e]
2025-07-13 22:30:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=q3lqbzll] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:30:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session q3lqbzll
2025-07-13 22:30:41 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:30:41 [clientInboundChannel-95] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=q3lqbzll
2025-07-13 22:30:41 [clientOutboundChannel-11] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=q3lqbzll}], simpSessionId=q3lqbzll}]
2025-07-13 22:30:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:45 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422445676", parameters={masked}
2025-07-13 22:30:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:30:45 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422445676
2025-07-13 22:30:45 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/902/b4armlhi/websocket", parameters={}
2025-07-13 22:30:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7a50482c
2025-07-13 22:30:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/902/b4armlhi/websocket
2025-07-13 22:30:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:30:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=b4armlhi]
2025-07-13 22:30:45 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09421050125
2025-07-13 22:30:45 [clientInboundChannel-98] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=b4armlhi
2025-07-13 22:30:45 [clientInboundChannel-101] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=b4armlhi
2025-07-13 22:30:45 [clientInboundChannel-104] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=b4armlhi
2025-07-13 22:30:45 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:30:45 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:30:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:30:45 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:30:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:46 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/2", parameters={}
2025-07-13 22:30:46 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:30:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:30:46 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:30:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:49 [clientInboundChannel-107] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=b4armlhi
2025-07-13 22:30:49 [clientInboundChannel-84] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=b4armlhi
2025-07-13 22:30:49 [clientInboundChannel-87] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=b4armlhi
2025-07-13 22:30:49 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:49 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [q3lqbzll]
2025-07-13 22:30:49 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:30:49 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:30:49 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:30:50 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:30:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:30:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:30:51 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:30:51 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:30:51 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=2", parameters={masked}
2025-07-13 22:30:51 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:30:52 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:31:14 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ikt0zcvv] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:31:14 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ikt0zcvv
2025-07-13 22:31:14 [http-nio-8080-exec-7] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:31:14 [clientInboundChannel-88] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ikt0zcvv
2025-07-13 22:31:14 [clientOutboundChannel-13] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=ikt0zcvv}], simpSessionId=ikt0zcvv}]
2025-07-13 22:31:19 [MessageBroker-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [ikt0zcvv]
2025-07-13 22:31:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=b4armlhi] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:31:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session b4armlhi
2025-07-13 22:31:52 [http-nio-8080-exec-10] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:31:52 [clientInboundChannel-111] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=b4armlhi
2025-07-13 22:31:52 [clientOutboundChannel-14] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=b4armlhi}], simpSessionId=b4armlhi}]
2025-07-13 22:31:54 [RMI TCP Connection(14)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:31:54 [RMI TCP Connection(14)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:31:55 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4c49471c]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:31:55 [RMI TCP Connection(14)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-13 22:31:57 [main] INFO  com.btalk.BackendApplication - Starting BackendApplication using Java 17.0.15 with PID 20156 (C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend\target\classes started by Thaw Htin Aung in C:\Users\Thaw Htin Aung\Desktop\B-Talk\backend)
2025-07-13 22:31:57 [main] INFO  com.btalk.BackendApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-13 22:31:58 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-13 22:31:58 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 112 ms. Found 6 JPA repository interfaces.
2025-07-13 22:31:59 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-13 22:31:59 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-13 22:31:59 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-13 22:31:59 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-13 22:31:59 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1891 ms
2025-07-13 22:31:59 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-13 22:31:59 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-13 22:31:59 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-13 22:31:59 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-13 22:32:00 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-13 22:32:01 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@839755f
2025-07-13 22:32:01 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-13 22:32:01 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-13 22:32:01 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-07-13 22:32:01 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-13 22:32:02 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-13 22:32:03 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:32:03 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-13 22:32:04 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsService
2025-07-13 22:32:06 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 18 mappings in 'requestMappingHandlerMapping'
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.AuthController:
	
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ChatController:
	{[MESSAGE],[/chat/{conversationId}/send]}: sendMessage(Long,MessageDto)
	{[MESSAGE],[/chat/{conversationId}/read]}: markMessagesAsRead(Long,Long)
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.ConversationController:
	
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.FileUploadController:
	
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.MessageController:
	
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.b.c.UserController:
	
2025-07-13 22:32:06 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-07-13 22:32:07 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-07-13 22:32:07 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-07-13 22:32:07 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:32:07 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:32:07 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-07-13 22:32:07 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@764b7ff7]
2025-07-13 22:32:07 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@764b7ff7]
2025-07-13 22:32:07 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@764b7ff7]]
2025-07-13 22:32:07 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-07-13 22:32:07 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:32:07 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:32:07 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-13 22:32:07 [main] INFO  com.btalk.BackendApplication - Started BackendApplication in 10.705 seconds (process running for 11.255)
2025-07-13 22:33:01 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-13 22:33:01 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-13 22:33:01 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-07-13 22:33:01 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-07-13 22:33:01 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-07-13 22:33:01 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@13106eec
2025-07-13 22:33:01 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@165e3835
2025-07-13 22:33:01 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-07-13 22:33:01 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-13 22:33:01 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422581801", parameters={masked}
2025-07-13 22:33:01 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:33:01 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422581801
2025-07-13 22:33:01 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:01 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/532/0n02qx11/websocket", parameters={}
2025-07-13 22:33:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:33:01 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/532/0n02qx11/websocket
2025-07-13 22:33:02 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:33:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=0n02qx11]
2025-07-13 22:33:02 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:33:02 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=0n02qx11
2025-07-13 22:33:02 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=0n02qx11
2025-07-13 22:33:02 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=0n02qx11
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:33:02 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:33:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:33:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:03 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=0n02qx11] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:33:03 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 0n02qx11
2025-07-13 22:33:03 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:33:03 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=0n02qx11
2025-07-13 22:33:03 [clientOutboundChannel-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=0n02qx11}], simpSessionId=0n02qx11}]
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:03 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422583568", parameters={masked}
2025-07-13 22:33:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:33:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422583568
2025-07-13 22:33:03 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:03 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/348/wxm1uztl/websocket", parameters={}
2025-07-13 22:33:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:33:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/348/wxm1uztl/websocket
2025-07-13 22:33:03 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:33:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=wxm1uztl]
2025-07-13 22:33:03 [http-nio-8080-exec-1] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:33:03 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=wxm1uztl
2025-07-13 22:33:03 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=wxm1uztl
2025-07-13 22:33:03 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=wxm1uztl
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:33:03 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:33:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:33:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:03 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:04 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:33:04 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:33:04 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:33:04 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=wxm1uztl
2025-07-13 22:33:04 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=wxm1uztl
2025-07-13 22:33:04 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=wxm1uztl
2025-07-13 22:33:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:04 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:33:04 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:33:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:33:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:33:05 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:33:05 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:05 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:33:06 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=wxm1uztl
2025-07-13 22:33:06 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=wxm1uztl
2025-07-13 22:33:06 [clientInboundChannel-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=wxm1uztl
2025-07-13 22:33:06 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=wxm1uztl
2025-07-13 22:33:06 [clientInboundChannel-12] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=wxm1uztl
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:33:06 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:06 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:33:07 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:33:07 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 45], outboundChannel[pool size = 3, active threads = 0, queued tasks = 0, completed tasks = 3], sockJsScheduler[pool size = 8, active threads = 1, queued tasks = 2, completed tasks = 2]
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:07 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:08 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:08 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:08 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:08 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:33:08 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:08 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:33:09 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:33:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:33:11 [MessageBroker-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [0n02qx11]
2025-07-13 22:34:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=wxm1uztl] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:34:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session wxm1uztl
2025-07-13 22:34:10 [http-nio-8080-exec-4] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:34:10 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=wxm1uztl
2025-07-13 22:34:10 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=wxm1uztl}], simpSessionId=wxm1uztl}]
2025-07-13 22:34:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:10 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422650535", parameters={masked}
2025-07-13 22:34:10 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:34:10 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422650535
2025-07-13 22:34:10 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/564/3welwnn1/websocket", parameters={}
2025-07-13 22:34:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:34:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/564/3welwnn1/websocket
2025-07-13 22:34:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:34:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=3welwnn1]
2025-07-13 22:34:10 [http-nio-8080-exec-2] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:34:10 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=3welwnn1
2025-07-13 22:34:10 [clientInboundChannel-40] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=3welwnn1
2025-07-13 22:34:10 [clientInboundChannel-43] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=3welwnn1
2025-07-13 22:34:10 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:34:10 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:34:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:34:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:34:10 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:34:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:34:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:12 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:34:12 [clientInboundChannel-46] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=3welwnn1
2025-07-13 22:34:12 [clientInboundChannel-49] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=3welwnn1
2025-07-13 22:34:12 [clientInboundChannel-52] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=3welwnn1
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:34:12 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:13 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:13 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:34:13 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:13 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:34:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:14 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:34:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:16 [MessageBroker-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [wxm1uztl]
2025-07-13 22:34:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=3welwnn1] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:34:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 3welwnn1
2025-07-13 22:34:51 [http-nio-8080-exec-6] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:34:51 [clientInboundChannel-55] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=3welwnn1
2025-07-13 22:34:51 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=3welwnn1}], simpSessionId=3welwnn1}]
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:52 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422692177", parameters={masked}
2025-07-13 22:34:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:34:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422692177
2025-07-13 22:34:52 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:52 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/481/j4c1vfhi/websocket", parameters={}
2025-07-13 22:34:52 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:34:52 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/481/j4c1vfhi/websocket
2025-07-13 22:34:52 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:34:52 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=j4c1vfhi]
2025-07-13 22:34:52 [http-nio-8080-exec-3] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:34:52 [clientInboundChannel-58] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=j4c1vfhi
2025-07-13 22:34:52 [clientInboundChannel-61] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=j4c1vfhi
2025-07-13 22:34:52 [clientInboundChannel-64] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=j4c1vfhi
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:52 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:34:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:34:53 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:34:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:55 [clientInboundChannel-35] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=j4c1vfhi
2025-07-13 22:34:55 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=j4c1vfhi
2025-07-13 22:34:55 [clientInboundChannel-41] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=j4c1vfhi
2025-07-13 22:34:55 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:55 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:34:55 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:34:55 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:34:55 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:34:55 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:34:56 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:56 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:56 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:34:56 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:34:56 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:34:56 [MessageBroker-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [3welwnn1]
2025-07-13 22:34:56 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:34:57 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:34:57 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:34:57 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:34:57 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:34:57 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:34:58 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=j4c1vfhi] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:37:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session j4c1vfhi
2025-07-13 22:37:07 [http-nio-8080-exec-10] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:37:07 [clientInboundChannel-66] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=j4c1vfhi
2025-07-13 22:37:07 [clientOutboundChannel-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=j4c1vfhi}], simpSessionId=j4c1vfhi}]
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:08 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422828125", parameters={masked}
2025-07-13 22:37:08 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:37:08 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422828125
2025-07-13 22:37:08 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:08 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/156/z4lkb12h/websocket", parameters={}
2025-07-13 22:37:08 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:37:08 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/156/z4lkb12h/websocket
2025-07-13 22:37:08 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:37:08 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=z4lkb12h]
2025-07-13 22:37:08 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:37:08 [clientInboundChannel-69] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=z4lkb12h
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:37:08 [clientInboundChannel-72] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=z4lkb12h
2025-07-13 22:37:08 [clientInboundChannel-75] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=z4lkb12h
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:08 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:37:09 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:09 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:37:09 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:37:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=z4lkb12h] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:37:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session z4lkb12h
2025-07-13 22:37:13 [http-nio-8080-exec-1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:37:13 [clientInboundChannel-78] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=z4lkb12h
2025-07-13 22:37:13 [clientOutboundChannel-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=z4lkb12h}], simpSessionId=z4lkb12h}]
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:14 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752422834074", parameters={masked}
2025-07-13 22:37:14 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:37:14 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752422834074
2025-07-13 22:37:14 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:14 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/940/tewhlr1k/websocket", parameters={}
2025-07-13 22:37:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:37:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/940/tewhlr1k/websocket
2025-07-13 22:37:14 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:37:14 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=tewhlr1k]
2025-07-13 22:37:14 [http-nio-8080-exec-8] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:37:14 [clientInboundChannel-81] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=tewhlr1k
2025-07-13 22:37:14 [clientInboundChannel-84] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=tewhlr1k
2025-07-13 22:37:14 [clientInboundChannel-87] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=tewhlr1k
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:37:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:15 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:37:15 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:37:15 [clientInboundChannel-90] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=tewhlr1k
2025-07-13 22:37:15 [clientInboundChannel-93] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=tewhlr1k
2025-07-13 22:37:15 [clientInboundChannel-96] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=tewhlr1k
2025-07-13 22:37:15 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:37:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:16 [MessageBroker-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [j4c1vfhi]
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:37:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:16 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:17 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:18 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:37:18 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:18 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:37:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:37:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:37:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:37:21 [MessageBroker-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [z4lkb12h]
2025-07-13 22:38:28 [clientInboundChannel-98] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-2 session=tewhlr1k
2025-07-13 22:38:28 [clientInboundChannel-101] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-3 session=tewhlr1k
2025-07-13 22:38:28 [clientInboundChannel-104] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-5 session=tewhlr1k
2025-07-13 22:38:28 [clientInboundChannel-107] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-6 session=tewhlr1k
2025-07-13 22:38:28 [clientInboundChannel-110] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-7 session=tewhlr1k
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:38:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:38:29 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:38:29 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:38:29 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:38:29 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:38:29 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:38:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:38:30 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:38:30 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:38:30 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:38:31 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=tewhlr1k] closed with CloseStatus[code=1000, reason=null]
2025-07-13 22:40:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session tewhlr1k
2025-07-13 22:40:02 [http-nio-8080-exec-8] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:40:02 [clientInboundChannel-113] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=tewhlr1k
2025-07-13 22:40:02 [clientOutboundChannel-12] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpSessionId=tewhlr1k}], simpSessionId=tewhlr1k}]
2025-07-13 22:40:02 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752423002805", parameters={masked}
2025-07-13 22:40:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:40:02 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752423002805
2025-07-13 22:40:02 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:02 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:40:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/562/yxbb2xk3/websocket", parameters={}
2025-07-13 22:40:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@118bace5
2025-07-13 22:40:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/562/yxbb2xk3/websocket
2025-07-13 22:40:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-13 22:40:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=yxbb2xk3]
2025-07-13 22:40:02 [http-nio-8080-exec-4] INFO  c.b.s.AuthChannelInterceptorAdapter - Authenticated WebSocket user: 09454159576
2025-07-13 22:40:02 [clientInboundChannel-116] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT session=yxbb2xk3
2025-07-13 22:40:02 [clientInboundChannel-119] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-0 session=yxbb2xk3
2025-07-13 22:40:02 [clientInboundChannel-122] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-1 session=yxbb2xk3
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:40:03 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:03 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:40:03 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/1", parameters={}
2025-07-13 22:40:03 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-13 22:40:03 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-13 22:40:04 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:05 [clientInboundChannel-125] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /queue/conversation-updates id=sub-2 session=yxbb2xk3
2025-07-13 22:40:05 [clientInboundChannel-128] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-3 session=yxbb2xk3
2025-07-13 22:40:05 [clientInboundChannel-131] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/13/messages id=sub-4 session=yxbb2xk3
2025-07-13 22:40:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:40:05 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:40:05 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:40:05 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:40:06 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:40:06 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:40:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:40:07 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/13?userId=1", parameters={masked}
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessages(Long, Long)
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:08 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-13 22:40:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-13 22:40:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=[MessageDto(messageId=63, co (truncated)...]
2025-07-13 22:40:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-13 22:40:11 [MessageBroker-12] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [tewhlr1k]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-13 22:43:30 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Closing SockJS session yxbb2xk3 with CloseStatus[code=1001, reason=null]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=yxbb2xk3]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:324)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Failure while sending SockJS close frame
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:250)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:223)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.close(AbstractSockJsSession.java:188)
	at org.springframework.web.socket.handler.WebSocketSessionDecorator.close(WebSocketSessionDecorator.java:164)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.close(ConcurrentWebSocketSessionDecorator.java:271)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:308)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.stop(SubProtocolWebSocketHandler.java:321)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStop(DefaultLifecycleProcessor.java:463)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.stop(DefaultLifecycleProcessor.java:618)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.stopBeans(DefaultLifecycleProcessor.java:432)
	at org.springframework.context.support.DefaultLifecycleProcessor.onClose(DefaultLifecycleProcessor.java:323)
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1172)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:179)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin.shutdown(SpringApplicationAdminMXBeanRegistrar.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:262)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:193)
	at java.management/com.sun.jmx.mbeanserver.ConvertingMethod.invokeWithOpenReturn(ConvertingMethod.java:175)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:117)
	at java.management/com.sun.jmx.mbeanserver.MXBeanIntrospector.invokeM2(MXBeanIntrospector.java:54)
	at java.management/com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
	at java.management/com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)
	at java.management/com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:252)
	at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:814)
	at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:802)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1472)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1310)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1405)
	at java.management.rmi/javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:360)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:200)
	at java.rmi/sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.rmi/sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:587)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:828)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:705)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:399)
	at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:704)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 61 common frames omitted
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=yxbb2xk3] closed with CloseStatus[code=1001, reason=null]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session yxbb2xk3
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] WARN  c.b.websocket.WebSocketEventListener - Disconnect event has no authenticated user
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@764b7ff7]]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@764b7ff7]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@764b7ff7]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-13 22:43:30 [RMI TCP Connection(15)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-13 22:43:31 [RMI TCP Connection(15)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
