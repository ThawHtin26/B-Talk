2025-07-17 00:03:27 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 14 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(14)-CONNECTED(14)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 669], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 45], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 2, completed tasks = 447]
2025-07-17 00:08:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=isho3ydm] closed with CloseStatus[code=1000, reason=null]
2025-07-17 00:08:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session isho3ydm
2025-07-17 00:08:28 [http-nio-8080-exec-10] INFO  c.b.websocket.WebSocketEventListener - User disconnected: 4
2025-07-17 00:08:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:29 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752687509436", parameters={masked}
2025-07-17 00:08:29 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@211d17c
2025-07-17 00:08:29 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752687509436
2025-07-17 00:08:29 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:29 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/640/c20j0rob/websocket", parameters={}
2025-07-17 00:08:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@211d17c
2025-07-17 00:08:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/640/c20j0rob/websocket
2025-07-17 00:08:29 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-17 00:08:29 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=c20j0rob]
2025-07-17 00:08:29 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/4", parameters={}
2025-07-17 00:08:29 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-17 00:08:29 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - WebSocket connected userId=4
2025-07-17 00:08:29 [http-nio-8080-exec-6] INFO  c.b.websocket.WebSocketEventListener - WebSocket connected: 4
2025-07-17 00:08:29 [clientInboundChannel-217] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=4 session=c20j0rob
2025-07-17 00:08:29 [clientOutboundChannel-46] INFO  c.b.websocket.WebSocketEventListener - User connected: 4
2025-07-17 00:08:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:29 [clientOutboundChannel-46] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:29 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:29 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:30 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:30 [clientInboundChannel-221] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/conversation-updates-userc20j0rob subscriptionId=sub-0 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-224] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/incoming-userc20j0rob subscriptionId=sub-1 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-227] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/answered-userc20j0rob subscriptionId=sub-2 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-230] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/rejected-userc20j0rob subscriptionId=sub-3 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-233] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/ended-userc20j0rob subscriptionId=sub-4 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-236] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/signals-userc20j0rob subscriptionId=sub-5 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-239] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/incoming-userc20j0rob subscriptionId=sub-6 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-242] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/answered-userc20j0rob subscriptionId=sub-7 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-245] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/rejected-userc20j0rob subscriptionId=sub-8 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-245] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/ended-userc20j0rob subscriptionId=sub-9 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [clientInboundChannel-218] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/signals-userc20j0rob subscriptionId=sub-10 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:08:30 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:30 [http-nio-8080-exec-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/69/user-offline session=null payload=4
2025-07-17 00:08:30 [clientInboundChannel-219] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=isho3ydm
2025-07-17 00:08:30 [clientOutboundChannel-47] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=com.btalk.security.StompPrincipal@4800ba10, simpSessionId=isho3ydm}], simpUser=com.btalk.security.StompPrincipal@4800ba10, simpSessionId=isho3ydm}]
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-17 00:08:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:30 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/4", parameters={}
2025-07-17 00:08:30 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-17 00:08:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:30 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-17 00:08:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:38 [MessageBroker-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [isho3ydm]
2025-07-17 00:08:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:40 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752687520702", parameters={masked}
2025-07-17 00:08:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@211d17c
2025-07-17 00:08:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752687520702
2025-07-17 00:08:40 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:40 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/665/ui5z2tt5/websocket", parameters={}
2025-07-17 00:08:40 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@211d17c
2025-07-17 00:08:40 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/665/ui5z2tt5/websocket
2025-07-17 00:08:40 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-17 00:08:40 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ui5z2tt5]
2025-07-17 00:08:40 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:40 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/4", parameters={}
2025-07-17 00:08:40 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-17 00:08:40 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - WebSocket connected userId=4
2025-07-17 00:08:40 [clientInboundChannel-223] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=4 session=ui5z2tt5
2025-07-17 00:08:40 [http-nio-8080-exec-6] INFO  c.b.websocket.WebSocketEventListener - WebSocket connected: 4
2025-07-17 00:08:40 [clientOutboundChannel-48] INFO  c.b.websocket.WebSocketEventListener - User connected: 4
2025-07-17 00:08:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:41 [clientOutboundChannel-48] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:41 [clientInboundChannel-226] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/conversation-updates-userui5z2tt5 subscriptionId=sub-0 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-226] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/incoming-userui5z2tt5 subscriptionId=sub-1 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-226] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/answered-userui5z2tt5 subscriptionId=sub-2 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-226] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/rejected-userui5z2tt5 subscriptionId=sub-3 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-227] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/ended-userui5z2tt5 subscriptionId=sub-4 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-236] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/signals-userui5z2tt5 subscriptionId=sub-5 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-243] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/incoming-userui5z2tt5 subscriptionId=sub-6 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-247] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/answered-userui5z2tt5 subscriptionId=sub-7 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-220] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/rejected-userui5z2tt5 subscriptionId=sub-8 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-220] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/ended-userui5z2tt5 subscriptionId=sub-9 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [clientInboundChannel-220] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/signals-userui5z2tt5 subscriptionId=sub-10 session=ui5z2tt5 user=4 payload=byte[0]
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-17 00:08:41 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:41 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/4", parameters={}
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:42 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:43 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:08:43 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-17 00:08:43 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:45 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ui5z2tt5] closed with CloseStatus[code=1000, reason=null]
2025-07-17 00:08:45 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ui5z2tt5
2025-07-17 00:08:45 [http-nio-8080-exec-4] INFO  c.b.websocket.WebSocketEventListener - User disconnected: 4
2025-07-17 00:08:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:08:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:45 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:46 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:46 [http-nio-8080-exec-4] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/69/user-offline session=null payload=4
2025-07-17 00:08:46 [clientInboundChannel-228] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ui5z2tt5
2025-07-17 00:08:46 [clientOutboundChannel-49] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=com.btalk.security.StompPrincipal@5b044552, simpSessionId=ui5z2tt5}], simpUser=com.btalk.security.StompPrincipal@5b044552, simpSessionId=ui5z2tt5}]
2025-07-17 00:08:53 [MessageBroker-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [ui5z2tt5]
2025-07-17 00:08:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/info?t=1752687535552", parameters={masked}
2025-07-17 00:08:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@211d17c
2025-07-17 00:08:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/info?t=1752687535552
2025-07-17 00:08:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/ws/086/ojm0nzqe/websocket", parameters={}
2025-07-17 00:08:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@211d17c
2025-07-17 00:08:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/ws/086/ojm0nzqe/websocket
2025-07-17 00:08:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-07-17 00:08:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ojm0nzqe]
2025-07-17 00:08:55 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:55 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/3", parameters={}
2025-07-17 00:08:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-17 00:08:55 [http-nio-8080-exec-6] INFO  c.b.s.AuthChannelInterceptorAdapter - WebSocket connected userId=3
2025-07-17 00:08:55 [http-nio-8080-exec-6] INFO  c.b.websocket.WebSocketEventListener - WebSocket connected: 3
2025-07-17 00:08:55 [clientInboundChannel-231] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=3 session=ojm0nzqe
2025-07-17 00:08:55 [clientOutboundChannel-50] INFO  c.b.websocket.WebSocketEventListener - User connected: 3
2025-07-17 00:08:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:55 [clientOutboundChannel-50] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:56 [clientInboundChannel-227] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/conversation-updates-userojm0nzqe subscriptionId=sub-0 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-227] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/incoming-userojm0nzqe subscriptionId=sub-1 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-227] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/answered-userojm0nzqe subscriptionId=sub-2 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-216] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/rejected-userojm0nzqe subscriptionId=sub-3 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-245] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/ended-userojm0nzqe subscriptionId=sub-4 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-217] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/signals-userojm0nzqe subscriptionId=sub-5 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-221] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/incoming-userojm0nzqe subscriptionId=sub-6 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-222] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/answered-userojm0nzqe subscriptionId=sub-7 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-226] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/rejected-userojm0nzqe subscriptionId=sub-8 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-230] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/ended-userojm0nzqe subscriptionId=sub-9 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [clientInboundChannel-233] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/call/signals-userojm0nzqe subscriptionId=sub-10 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-17 00:08:56 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:08:56 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:08:56 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/conversations/user/3", parameters={}
2025-07-17 00:08:56 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.ConversationController#getUserConversations(Long)
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Conversations retrieved successfully, data=[ConversationDto(conver (truncated)...]
2025-07-17 00:08:57 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:01 [clientInboundChannel-235] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/conversation-updates-userojm0nzqe subscriptionId=sub-11 session=ojm0nzqe user=3 payload=byte[0]
2025-07-17 00:09:01 [clientInboundChannel-237] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/69/messages id=sub-12 session=ojm0nzqe
2025-07-17 00:09:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:01 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=3&page=0&size=20", parameters={masked}
2025-07-17 00:09:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:03 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:03 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:03 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=3&page=0&size=20", parameters={masked}
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:03 [clientInboundChannel-239] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/69/messages id=sub-12 session=c20j0rob
2025-07-17 00:09:03 [clientInboundChannel-241] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/conversation-updates-userc20j0rob subscriptionId=sub-11 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:09:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:03 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:03 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=4&page=0&size=20", parameters={masked}
2025-07-17 00:09:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:05 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:05 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=3&page=0&size=20", parameters={masked}
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=4&page=0&size=20", parameters={masked}
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:05 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=4&page=0&size=20", parameters={masked}
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:07 [clientInboundChannel-245] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /app/app/call/start session=ojm0nzqe application/json payload={"callId":"4vur8se9ae2","callerId":3,"conversationId":69,"callType":"PRIVATE","s...(truncated), lookupDestination='/app/call/start'
2025-07-17 00:09:07 [clientInboundChannel-245] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - No matching message handler methods.
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:09 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:10 [clientInboundChannel-217] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /app/app/call/start session=c20j0rob application/json payload={"callId":"oxcb2hy8kt8","callerId":4,"conversationId":69,"callType":"PRIVATE","s...(truncated), lookupDestination='/app/call/start'
2025-07-17 00:09:10 [clientInboundChannel-217] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - No matching message handler methods.
2025-07-17 00:09:30 [clientInboundChannel-249] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-11 session=c20j0rob
2025-07-17 00:09:30 [clientInboundChannel-252] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing UNSUBSCRIBE id=sub-12 session=c20j0rob
2025-07-17 00:09:30 [clientInboundChannel-252] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/queue/conversation-updates-userc20j0rob subscriptionId=sub-13 session=c20j0rob user=4 payload=byte[0]
2025-07-17 00:09:30 [clientInboundChannel-229] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/conversation/69/messages id=sub-14 session=c20j0rob
2025-07-17 00:09:30 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=4&page=0&size=20", parameters={masked}
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:31 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:32 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:09:32 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.phone_number=?
2025-07-17 00:09:32 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/messages/conversation/69/page?userId=4&page=0&size=20", parameters={masked}
2025-07-17 00:09:32 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.btalk.controller.MessageController#getConversationMessagesPaginated(Long, Long, int, int)
2025-07-17 00:09:32 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=? 
        and p1_0.user_id=? 
    limit
        ?
2025-07-17 00:09:32 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        ?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:33 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:34 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:09:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-07-17 00:09:34 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(success=true, message=Messages retrieved successfully, data=Page 1 of 1 containing com.b (truncated)...]
2025-07-17 00:09:34 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-07-17 00:10:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ojm0nzqe] closed with CloseStatus[code=1000, reason=null]
2025-07-17 00:10:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session ojm0nzqe
2025-07-17 00:10:00 [http-nio-8080-exec-8] INFO  c.b.websocket.WebSocketEventListener - User disconnected: 3
2025-07-17 00:10:00 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:10:01 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:10:02 [http-nio-8080-exec-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/69/user-offline session=null payload=3
2025-07-17 00:10:02 [clientInboundChannel-254] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=ojm0nzqe
2025-07-17 00:10:02 [clientOutboundChannel-51] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=com.btalk.security.StompPrincipal@7929ffa5, simpSessionId=ojm0nzqe}], simpUser=com.btalk.security.StompPrincipal@7929ffa5, simpSessionId=ojm0nzqe}]
2025-07-17 00:10:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=c20j0rob] closed with CloseStatus[code=1000, reason=null]
2025-07-17 00:10:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session c20j0rob
2025-07-17 00:10:03 [http-nio-8080-exec-6] INFO  c.b.websocket.WebSocketEventListener - User disconnected: 4
2025-07-17 00:10:03 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        users u1_0 
    set
        status=? 
    where
        u1_0.user_id=?
2025-07-17 00:10:03 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        c1_0.conversation_id,
        c1_0.created_at,
        c1_0.creator_id,
        c1_0.name,
        c1_0.type 
    from
        conversations c1_0 
    join
        participants p1_0 
            on c1_0.conversation_id=p1_0.conversation_id 
    where
        p1_0.user_id=?
2025-07-17 00:10:03 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        p1_0.participant_id,
        p1_0.conversation_id,
        p1_0.joined_at,
        p1_0.left_at,
        p1_0.user_id 
    from
        participants p1_0 
    where
        p1_0.conversation_id=?
2025-07-17 00:10:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:10:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.created_at,
        u1_0.last_name,
        u1_0.name,
        u1_0.password_hash,
        u1_0.phone_number,
        u1_0.profile_photo_url,
        u1_0.status 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-07-17 00:10:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        m1_0.message_id,
        m1_0.content,
        m1_0.conversation_id,
        m1_0.message_type,
        m1_0.sender_id,
        m1_0.sent_at 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
    order by
        m1_0.sent_at desc 
    limit
        1
2025-07-17 00:10:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        a1_0.attachment_id,
        a1_0.file_size_bytes,
        a1_0.file_type,
        a1_0.file_url,
        a1_0.message_id 
    from
        attachments a1_0 
    where
        a1_0.message_id=?
2025-07-17 00:10:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(m1_0.message_id) 
    from
        messages m1_0 
    where
        m1_0.conversation_id=? 
        and m1_0.sender_id<>? 
        and not exists(select
            mr1_0.id 
        from
            message_reads mr1_0 
        where
            mr1_0.message_id=m1_0.message_id 
            and mr1_0.user_id=?)
2025-07-17 00:10:04 [http-nio-8080-exec-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/conversation/69/user-offline session=null payload=4
2025-07-17 00:10:04 [clientInboundChannel-257] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=c20j0rob
2025-07-17 00:10:04 [clientOutboundChannel-52] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=com.btalk.security.StompPrincipal@62eaa60c, simpSessionId=c20j0rob}], simpUser=com.btalk.security.StompPrincipal@62eaa60c, simpSessionId=c20j0rob}]
2025-07-17 00:10:08 [MessageBroker-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [ojm0nzqe]
2025-07-17 00:10:13 [MessageBroker-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [c20j0rob]
2025-07-17 00:21:42 [RMI TCP Connection(56)-127.0.0.1] INFO  o.s.b.a.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
2025-07-17 00:21:42 [RMI TCP Connection(56)-127.0.0.1] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-17 00:21:43 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68437190]]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68437190]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68437190]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-17 00:21:43 [RMI TCP Connection(56)-127.0.0.1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
